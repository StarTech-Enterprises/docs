<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176158185-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176158185-1');
</script>

		<title>The Challenge! - combining revenue files | StarBase </title>
		<!-- link to website tab icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/../docs/assets/images/alt-logo-star-tilted.png" />
		<!-- link to Main Stylesheets -->
		<link rel="stylesheet" type="text/css" href="/../docs/assets/css/styles.css">
		<!-- link to Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Zilla Slab' rel='stylesheet'>
		<!-- link to Font awesome -->
		<script src="https://kit.fontawesome.com/378306bc97.js" crossorigin="anonymous"></script>
		<!-- link to Material Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- link to Iconify CDN -->
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<!-- link to UUID -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv5.min.js"></script>
	</head>
	<body>
		<a id="top"></a>
			<!-- Header Holder --> 

<div class="header-holder has-default-focus"  >
    <div class="nav-bar">
        <!---->
        <a class="nav-bar-button has-padding-left-medium has-padding-left-none-tablet" href="https://sachin1882.wixsite.com/startechenterprises/guides" title="Go to parent site: StarTech Enterprises">
            <div class="nav-bar-logo has-background-image">
                <img src="https://fontmeme.com/permalink/200623/587d8aec23ed76c10e0b1ec43bc85f23.png" class="alt-logo has-background-image" width="180" height ="70">
                <div class="overlay">
                    <img src="/../docs/assets/images/starbase_logo.png" class="nav-bar-logo">
                </div>
            </div>
        </a>
        <nav class="nav-bar-nav">
            <ul class="nav-bar-nav-list">
                <li class="nav-bar-item is-category has-spacing">
                    <a class = "nav-bar-button title has-hover-underline is-6" href="/docs/">
                        <span>
                            <!---->
                            Docs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/">
                        <span>
                            <!---->
                            Guides
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/tech-blogs/">
                        <span>
                            <!---->
                            Articles & Blogs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/videos/">
                        <span>
                            <!---->
                            Videos
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/about/">
                        <span>
                            <!---->
                            About
                            <!---->
                        </span>
                    </a>
                </li>
            </ul>
        </nav>
        <span class = "nav-bar-spacer i-hidden-mobile"></span>
        <!---->
    </div>
    
    <div class="content-header uhf-container has-padding has-default-focus has-border-bottom-none is-flexbox">
        
<!-- Get correct Breadcrumb Links from Front Matter of loaded page-->

<!-- Liquid Code -->
    <!-- Page Root -->
    

    <!-- Page Type -->
    

    <!-- Page Category -->
    

    <!-- Page Series -->
    
<!-- / End of Liquid Code -->


<!-- Breadcrumb Links --> 
<nav class = "has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow">
    <ul id="page-breadcrumbs" class="breadcrumbs">
        <li><a href="/docs/"><span class ="">Docs</span></a></li>
        <li><a href="/docs/"><span class ="">Guides</span></a></li>
        <li><a href="/docs/guides/data-integration-and-etl/etl.html"><span class="">Data Integration & ETL</span></a></li>
        <li><a href=/docs/guides/data-integration-and-etl/data-wrangling-techniques/introduction.html><span class="">Data Wrangling Techniques</span></a></li>

        <!-- This part needs to be generated by JavaScript-->

    </ul>
</nav>
<!-- end of / Breadcrumb links -->




        <!-- Page Functions --> 

<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
    <ul class="is-hidden-mobile action-list has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
        <li>
            <button class="print button is-text has-inner-focus is-small is-icon-only-touch colorfill" type="button" title="Print this page" onclick="window.print()">
                <span class="icon">
                    <span class="iconify extra-small" data-icon="el:print" data-inline="false"></span>                </span>
                <span class="is-visually-hidden-touch is-hidden-portrait">Print</span>
            </button>
        </li>
        <li>
            <button class="button is-text has-inner-focus is-small is-icon-only-touch colorfill" title="Send feedback about this page" onclick="location.href='#feedback'">
                <span class="icon">
                    <i class="fas fa-comments"></i>
                </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
            </button>
        </li>
        <li id="share-menu-link">
            <div class = "sharing dropdown has-caret">
                <button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch colorfill" title="Share This Document">
                    <span class="icon">
                        <span class="iconify extra-small" data-icon="ls:share" data-inline="false"></span>
                    </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
                </button>
                <div id="sharing-menu" class="sharing-menu has-padding-small is-hidden">
                    <ul>
                        <li id="twitter-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-twitter colorfill"></i>
                                </span>
                                <span>Twitter</span>
                            </a>
                        </li>
                        <li id="linkedin-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-linkedin-in colorfill"></i>
                                </span>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li id="facebook-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-facebook-f colorfill"></i>
                                </span>
                                <span>Facebook</span>
                            </a>
                        </li>
                        <li id="email-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fas fa-envelope colorfill"></i>
                                </span>
                                <span>Email</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ul>
</div>

<!-- end of / Page Functions -->
    </div>
    
</div>

<!-- end of /.header-holder -->
			<!-- Main Container --> 
<div class="mainContainer uhf-container  has-top-padding ">
    <div class="columns has-large-gaps is-gapless-mobile ">

        
        <!-- Left Hand Side Tree-->
        <div class="left-sidebar column is-hidden-mobile  is-one-third-tablet is-one-quarter-desktop ">
            <nav class ="is-fixed is-flex is-flex-column" id="affixed-left-sidebar">
                
                
                <form class = "has-margin-bottom-small" action="javascript:" role="search">
                    <label class="visually-hidden">Search</label>
                    <div class="searchFilter is-block">
                        <div class="control has-icons-left">
                            <input id="searchFilter" class="searchFilter-input input control has-icons-left is-full-width is-small" role="combobox" maxlength="100" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" placeholder="Filter by title" type="text">
                            <span class="icon is-small is-left">
                                <img src="/../docs/assets/images/filter.png" class="filter-icon">
                            </span>
                        </div>
                        <ul class="searchFilter-suggestions is-vertically-scrollable is-hidden"></ul>
                    </div>
                </form>

                <ul class="toc is-vertically-scrollable has-flex-grow has-flex-shrink">
                    <!-- Menu Series -->
                    
                    
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/introduction.html">Introduction</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/mismatched-tables.html">Mismatched Tables</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/preserving-context.html">Preserving Context</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/data-into-tables.html">Transforming Data into Tables</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/generalised-unpivoting.html">Generalised unpivoting</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/generalisable-function.html">Creating a Generalisable function</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/slowly-changing-datasets.html">Dealing with slowly changing Datasets</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/the-challenge.html">The Challenge! - combining revenue files</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/data-cop.html">Data Cop! - detecting revenue changes</a></li>
    
          
        
      </li>
  
</ul>
                </ul>
                
            </nav>
        </div>
         <!-- end of /left hand side tree -->
        

        <!-- Primary Holder -->    
        <div class="primary-holder column   is-two-thirds-tablet is-three-quarters-desktop ">
            <div class="columns has-large-gaps is-gapless-mobile ">

                 <!-- Main Column -->
                <div id="main-column" class="column  is-full is-four-fifths-desktop ">
                    <main id="main" class ="content" lang="eng-us">
                        <h1 id="the-challenge---combining-revenue-files">The Challenge! - combining revenue files</h1>
<time class="metadata" style="text-alstyleign:left"> Guides • Data Integration &amp; ETL • 23/06/2019</time>

<h2 id="the-challenge">The Challenge!</h2>

<p>In this article, we bring together different elements, to overcome a particular challenge:</p>

<p>You have just been appointed Chief Information Officer of Galactic Ventures Limited, but last weekend, the company’s data warehouse was hit massive cyber-attack, and you have been called in to save the day!</p>

<p>The challenge is to try to re-construct a new report from the company’s old revenue data (what is left of it anyway…)</p>

<p>Luckily, your predecessor did some record-keeping, and kept all the revenue reports for the years 2015 to 2017, in three Excel workbooks. Each workbook has 12 worksheets, one for each month of the year (i.e. Jan, Feb, Mar…. Dec).</p>

<p>The 2018 revenue file however was kept in a different CSV format. (God knows why, but, for now, just accept that it was!)</p>

<p>The goal is now to try and combine data from all 36 worksheets for the years 2015 to 2017 (data currently stored in pivoted data table format) - together with the 2018 revenue data (data currently in multi-line record format), into one single table, like the one shown below:</p>

<figure>
    
        <img class="docimage" src="images/the-challenge-01.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Combining Multiple Tables of Galactic Ventures Limited from four workbooks: (2015 – 2017), each with 12 worksheets, stored in pivoted data table format, and a 2018 CSV file, stored in multi-line record format</i>
    </figcaption>
    
</figure>

<p>The problem can be solved by breaking it down into three parts. The solution to each is laid out in the follow sections.</p>

<h2 id="combining-xlsx-files">Combining xlsx files</h2>

<p>To start with, the three revenue files that are in the same format (2015 to 2017):</p>

<h3 id="1-load-the-data">1.	Load the data</h3>

<ul>
  <li>
    <p>Open a Blank Query in Excel. Then, in Excel, select the Data tab, then ‘Get Data’, then ‘From File’, then ‘From Folder’</p>
  </li>
  <li>
    <p>Select the Folder where the old Revenue files are kept, as shown here:</p>
  </li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-02.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<ul>
  <li>Filter out the 2018.csv file, which has a different format to the other files.</li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-03.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<ul>
  <li>Rename the Query to <em>“Revenues”</em></li>
</ul>

<h3 id="2-combine-files">2.	Combine Files</h3>

<ul>
  <li>
    <p>Next, click on the <em>“Content”</em> column, and then click on the “Combine Files” icon on the Home tab.</p>
  </li>
  <li>
    <p>In the Combine Files dialog box that appears, right click on “Sample File Parameter1”, and select Edit, as shown below:</p>
  </li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-04.png" alt="" style="width: 100%; max-width: 52.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p>This step is quite important as it will auto-generate a series of other queries, that will show up on the left-hand pane, as shown below. Do not become too concerned with why they are there, and what they do, just know that because you are pulling data from a folder, instead of a single file – they are needed.</p>

<figure>
    
        <img class="docimage" src="images/the-challenge-05.png" alt="" style="width: 100%; max-width: 52.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<ul>
  <li>With the necessary queries generated, click back to the “<em>Revenues</em>” Query, and remove all but the first three columns, as shown below:</li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-06.png" alt="" style="width: 100%; max-width: 85.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<ul>
  <li>Now rename the first two columns to “Year”, and “Month” respectively, as shown:</li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-07.png" alt="" style="width: 100%; max-width: 85.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<h3 id="3-create-function-1">3.	Create function 1</h3>

<ul>
  <li>Next, create a function that will clean up the data from each of the 36 Tables (there are 12 in each file).</li>
</ul>

<p>The function you create should automatically remove the 1st row, which is not needed, the last column (which is the Grand Total column), which is not needed, and then the last row (which is the Grant Total row), which is also not needed.</p>

<ul>
  <li>Create the function as follows, by creating a Blank Query:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
fnCleanSummarizedTable

(inputTable) =&gt;
let
    SkipFirstRow = Table.Skip(inputTable, 1),
NoGrandTotalColumn = Table.RemoveColumns(SkipFirstRow, { List.Last(Table.ColumnNames(SkipFirstRow)) } ),
    Result = Table.RemoveLastN(NoGrandTotalColumn, 1)
in
    Result
">
  </button>
</div>
<pre><code class="language-powerquery-m">fnCleanSummarizedTable

(inputTable) =&gt;
let
    SkipFirstRow = Table.Skip(inputTable, 1),
NoGrandTotalColumn = Table.RemoveColumns(SkipFirstRow, { List.Last(Table.ColumnNames(SkipFirstRow)) } ),
    Result = Table.RemoveLastN(NoGrandTotalColumn, 1)
in
    Result
</code></pre>

<p>The function should:</p>

<ul>
  <li>Skip the first row</li>
  <li>Delete the last column</li>
  <li>Delete the bottom most row</li>
</ul>

<p>Now, include the following Applied Step:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.AddColumn(#&quot;Renamed Columns&quot;, &quot;fnCleanSummarizedTable&quot;, each fnCleanSummarizedTable([Data]))
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.AddColumn(#"Renamed Columns", "fnCleanSummarizedTable", each fnCleanSummarizedTable([Data]))
</code></pre>

<p>A new column should appear:</p>

<figure>
    
        <img class="docimage" src="images/the-challenge-08.png" alt="" style="width: 100%; max-width: 85.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<ul>
  <li>Finally, rename the column to <em>“Summarized Table”</em>, and remove the column called <em>“Data”</em>, which is now no longer needed.</li>
</ul>

<h3 id="4-create-function-2">4.	Create function 2</h3>

<ul>
  <li>Create another function that will take the data from these Summarized Table’s and unpivot their content.</li>
</ul>

<p>Use the following code:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

fnUnpivotSummarizedTable

let
    Source = (Source, RowFields, ColumnFields, ValueField)=&gt;
let
    #&quot;Filled Down&quot; = Table.FillDown(Source, List.FirstN(Table.ColumnNames(Source), List.Count(RowFields) - 1)),
    #&quot;Merged Columns&quot; = Table.CombineColumns(#&quot;Filled Down&quot;, List.FirstN(Table.ColumnNames(#&quot;Filled Down&quot;), List.Count(RowFields)), Combiner.CombineTextByDelimiter(&quot;:&quot;, QuoteStyle.None),&quot;Merged&quot;),
    #&quot;Transposed Table&quot; = Table.Transpose(#&quot;Merged Columns&quot;),
    #&quot;Filled Down1&quot; = Table.FillDown(#&quot;Transposed Table&quot;,List.FirstN(Table.ColumnNames(#&quot;Transposed Table&quot;), List.Count(ColumnFields)-1)),
    #&quot;Promoted Headers&quot; = Table.PromoteHeaders(#&quot;Filled Down1&quot;, [PromoteAllScalars=true]),
    #&quot;Unpivoted Other Columns&quot; = Table.UnpivotOtherColumns(#&quot;Promoted Headers&quot;,List.FirstN(Table.ColumnNames(#&quot;Promoted Headers&quot;), List.Count(ColumnFields)) , &quot;Attribute&quot;, ValueField),
    #&quot;Split Column by Delimiter&quot; = Table.SplitColumn(#&quot;Unpivoted Other Columns&quot;, &quot;Attribute&quot;, Splitter.SplitTextByDelimiter(&quot;:&quot;, QuoteStyle.Csv), RowFields),
    #&quot;Renamed Columns&quot; = Table.RenameColumns(#&quot;Split Column by Delimiter&quot;, List.Zip({List.FirstN(Table.ColumnNames(#&quot;Split Column by Delimiter&quot;), List.Count(ColumnFields)), ColumnFields})),
    #&quot;Changed Type&quot; = Table.TransformColumnTypes(#&quot;Renamed Columns&quot;,{{ValueField, type number}})
in
    #&quot;Changed Type&quot;
in
    Source

">
  </button>
</div>
<pre><code class="language-powerquery-m">
fnUnpivotSummarizedTable

let
    Source = (Source, RowFields, ColumnFields, ValueField)=&gt;
let
    #"Filled Down" = Table.FillDown(Source, List.FirstN(Table.ColumnNames(Source), List.Count(RowFields) - 1)),
    #"Merged Columns" = Table.CombineColumns(#"Filled Down", List.FirstN(Table.ColumnNames(#"Filled Down"), List.Count(RowFields)), Combiner.CombineTextByDelimiter(":", QuoteStyle.None),"Merged"),
    #"Transposed Table" = Table.Transpose(#"Merged Columns"),
    #"Filled Down1" = Table.FillDown(#"Transposed Table",List.FirstN(Table.ColumnNames(#"Transposed Table"), List.Count(ColumnFields)-1)),
    #"Promoted Headers" = Table.PromoteHeaders(#"Filled Down1", [PromoteAllScalars=true]),
    #"Unpivoted Other Columns" = Table.UnpivotOtherColumns(#"Promoted Headers",List.FirstN(Table.ColumnNames(#"Promoted Headers"), List.Count(ColumnFields)) , "Attribute", ValueField),
    #"Split Column by Delimiter" = Table.SplitColumn(#"Unpivoted Other Columns", "Attribute", Splitter.SplitTextByDelimiter(":", QuoteStyle.Csv), RowFields),
    #"Renamed Columns" = Table.RenameColumns(#"Split Column by Delimiter", List.Zip({List.FirstN(Table.ColumnNames(#"Split Column by Delimiter"), List.Count(ColumnFields)), ColumnFields})),
    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{ValueField, type number}})
in
    #"Changed Type"
in
    Source

</code></pre>

<p>The function takes in four arguments. (Refer to this article on <a href="generalisable-function.html">Creating a Generalisable function</a>, for more details on how this function works)</p>

<ul>
  <li>Now, call the function by adding the following Applied Step:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.AddColumn(#&quot;Removed Columns&quot;, &quot;Unpivoted&quot;, each FnUnpivotSummarizedTable([Summarized Table], {&quot;Customer Category&quot;, &quot;City&quot;}, {&quot;Color&quot;, &quot;Supplier Category&quot;, &quot;Supplier Name&quot;}, &quot;Revenue&quot;))
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.AddColumn(#"Removed Columns", "Unpivoted", each FnUnpivotSummarizedTable([Summarized Table], {"Customer Category", "City"}, {"Color", "Supplier Category", "Supplier Name"}, "Revenue"))
</code></pre>

<p>The query should now look as follows:</p>

<figure>
    
        <img class="docimage" src="images/the-challenge-09.png" alt="" style="width: 100%; max-width: 85.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<ul>
  <li>
    <p>Remove the “<em>Summarized Table</em>” column, as this is now no longer needed.</p>
  </li>
  <li>
    <p>Finally, expand the Unpivoted Column, deselecting “Use Original Column Name As Prefix” option, and then click OK.</p>
  </li>
</ul>

<p>The data should now be in the format needed.</p>

<figure>
    
        <img class="docimage" src="images/the-challenge-10.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p><strong>UNFORTUNATELY, THOUGH, THIS IS ONLY…</strong></p>

<p><strong>…HALF THE BATTLE!</strong></p>

<p>You next need to transform the 2018 Revenue data – which was in a different format.</p>

<h2 id="loading-csv-file">Loading csv file</h2>

<ul>
  <li>To transform the 2018.csv file into the right shape, in the Power Query Editor, select “New Source”, and Choose File, and then Text/CSV.</li>
</ul>

<h3 id="1-load-the-data-1">1.	Load the data</h3>

<ul>
  <li>Import the CSV file (as explained above), and rename the query to “<em>2018 Revenues</em>”, so that you see something like the below:</li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-11.png" alt="" style="width: 100%; max-width: 52.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<ul>
  <li>On the Transform Tab, select “Use First Row As Headers”</li>
</ul>

<h3 id="2-add-an-index-column">2.	Add an index column</h3>

<ul>
  <li>Then, on the Add Column Tab, select Index Column, like so:</li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-12.png" alt="" style="width: 100%; max-width: 65.9%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<h3 id="3-create-a-conditional-column">3.	Create a conditional column</h3>

<ul>
  <li>Now, create a Conditional Column, with the following parameters:</li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-13.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p>The data should look like this:</p>

<figure>
    
        <img class="docimage" src="images/the-challenge-14.png" alt="" style="width: 100%; max-width: 85.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<h3 id="4-fill-down-the-data">4.	Fill down the data</h3>

<ul>
  <li>Now, select the <em>‘Row ID’</em> column, and then on the Transform Tab, select Fill, Down, so the data looks like this:</li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-15.png" alt="" style="width: 100%; max-width: 85.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<ul>
  <li>Delete the Index column, as it is no longer needed.</li>
</ul>

<h3 id="5--pivot-the-data">5.  Pivot the data</h3>

<ul>
  <li>Now, select the “<em>Attribute</em>” Column, and on the Transform Tab, select Pivot Column.</li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-16.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p>The data should now look like this:</p>

<figure>
    
        <img class="docimage" src="images/the-challenge-17.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<ul>
  <li>Now, remove the Row ID column, as it is not needed:</li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-18.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p><strong>WE ARE NOW 5/6ths OF THE WAY THERE!</strong></p>

<p>The final, last step is to append both queries together into one final dataset.</p>

<h2 id="combining-all-files">Combining all files</h2>

<p>Now you need to append the two earlier datasets together to form one whole.</p>

<h3 id="1-merge-columns">1.	Merge Columns</h3>

<ul>
  <li>
    <p>Go back, and select the “<em>Revenues</em>” query, and select the columns called “Year” and “Month”, and then on the Transform Tab, select Merge Columns.</p>
  </li>
  <li>
    <p>In the Merge Columns Dialog Box that appears, select Space as the Delimiter, and enter Date in the New Column Name box. Then click OK.</p>
  </li>
</ul>

<figure>
    
        <img class="docimage" src="images/the-challenge-19.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<h3 id="2-append-queries">2.	Append Queries</h3>

<ul>
  <li>Next, on the Home Tab, select Append Queries. In the Append Dialog box that appears, set the Table to Append “<em>2018 Revenues</em>”, and then click OK.</li>
</ul>

<h3 id="3-set-data-types">3.	Set Data types</h3>

<ul>
  <li>Change the Data Type of the columns, “<em>Revenue</em>”, and “<em>Date</em>”, to “Currency”, and “Date” respectively.</li>
</ul>

<h3 id="4-close--load">4.	Close &amp; load</h3>

<ul>
  <li>Finally, load the final query, by clicking on “Close &amp; Load”!</li>
</ul>

<p>If all has gone according to plan, you should see this….</p>

<figure>
    
        <img class="docimage" src="images/the-challenge-20.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p>All the data, from 2015 to 2018, should now be in one Dataset! Congratulations!</p>

<p><strong>GALATIC VENTURES LIMITED IS STILL IN BUSINESS!</strong></p>

                        
                            <div id="mainNavBottom">
    <a class="no_icon" href="">
        <span id="previousPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-back" data-inline="false"></span>
        </span>
    </a>
    <a class="no_icon" href="">
        <span id="nextPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-forward" data-inline="false"></span>					
        </span>
    </a>
</div>
                        
                    </main>	
                    
                        <!-- Start of Feedback section -->
<section class="feedback-section is-relative">
    <h2 id="feedback" class="is-size-2 has-margin-top-large has-padding-top-medium"> Feedback </h2>
    <div class="feedback has-margin-top-small has-margin-bottom-none">
        <p id="send-feedback-about" class="has-margin-top-none has-margin-bottom-none">
            Submit and view feedback
        </p>
        <div id="feedback-section-link" class="has-margin-top-large has-margin-bottom-none">
            <a class="button has-margin-bottom-small" href="" target="_blank">
                <span class="icon">
                    <span class=github>
                        <i class="fab fa-github"></i>
                    </span>
                </span>
                <span>This page</span>
            </a>
        </div>
    </div>
    <div id="viewallfeedback-section-link" class="is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-medium">
        <a class="view-on-github" href="" target="_blank">
            <span class="icon">
                <span class=github>
                    <i class="fab fa-github"></i>
                </span>
            </span><span>View all page feedback</span>
        </a>
    </div>
</section>

<!-- End of Feedback section -->
                    
                </div>

                
                 <!-- Right Hand Side Toc-->
                 <div class="right-sidebar column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only">
                    <nav class="doc-outline is-fixed is-vertically-scrollable", id="affixed-right-sidebar">
                        <nav id="side-doc-outline">
                            <header id="side-doc-title" class = "is-flex is-flex-row">
                                <div>
                                    <a href="#top">
                                        <h3 title="Go to Top of Page">
                                            <i class="fas fa-file-alt" style="color:#e82127;">&nbsp;</i>
                                            In this article
                                        </h3>
                                    </a>
                                </div>
                            </header>
                            <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#the-challenge">The Challenge!</a></li>
<li class="toc-entry toc-h2"><a href="#combining-xlsx-files">Combining xlsx files</a>
<ul>
<li class="toc-entry toc-h3"><a href="#1-load-the-data">1.	Load the data</a></li>
<li class="toc-entry toc-h3"><a href="#2-combine-files">2.	Combine Files</a></li>
<li class="toc-entry toc-h3"><a href="#3-create-function-1">3.	Create function 1</a></li>
<li class="toc-entry toc-h3"><a href="#4-create-function-2">4.	Create function 2</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#loading-csv-file">Loading csv file</a>
<ul>
<li class="toc-entry toc-h3"><a href="#1-load-the-data-1">1.	Load the data</a></li>
<li class="toc-entry toc-h3"><a href="#2-add-an-index-column">2.	Add an index column</a></li>
<li class="toc-entry toc-h3"><a href="#3-create-a-conditional-column">3.	Create a conditional column</a></li>
<li class="toc-entry toc-h3"><a href="#4-fill-down-the-data">4.	Fill down the data</a></li>
<li class="toc-entry toc-h3"><a href="#5--pivot-the-data">5.  Pivot the data</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#combining-all-files">Combining all files</a>
<ul>
<li class="toc-entry toc-h3"><a href="#1-merge-columns">1.	Merge Columns</a></li>
<li class="toc-entry toc-h3"><a href="#2-append-queries">2.	Append Queries</a></li>
<li class="toc-entry toc-h3"><a href="#3-set-data-types">3.	Set Data types</a></li>
<li class="toc-entry toc-h3"><a href="#4-close--load">4.	Close &amp; load</a></li>
</ul>
</li>
</ul>
                        </nav>

                        <!-- Fixed Element-->
                        <div>
                            <a class="top-link hide" href="" id="js-top" title="Go to Top of Page">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>
                            </a>
                        </div>
                    </nav>
                </div>
                
            </div>
            <!-- end of /.columns -->
        </div>	
        <!-- end of /primary holder -->

    </div>
    <!-- end of /.columns -->
</div>
<!-- end of /.mainContainer -->
			<!-- Footer Container --> 
<div class="footerContainer">

    
    

    <footer id="footer" class=" footer-layout   uhf-container has-padding">
        <div class="">
            <a href="https://startech-enterprises.github.io/docs/">
                <img src="/../docs/assets/images/starbase_logo.png" class="footer-bar-logo">
            </a>
        </div>
        <div class="is-flex is-full-height has-padding-right-extra-large-desktop has-padding-left-extra-large-desktop">
            <a class="locale-selector-link has-flex-shrink-none" href="/../">
                <span class="icon">
                    <span><i class="fas fa-globe"></i></span>
                </span>
                <span class="locale-selector-link-text">English (United Kingdom)</span>
            </a>
        </div>
        <ul class="links">
            <li>
                <a href="/docs/">Docs</a>
            </li>
            <li>
                <a href="/docs/guides/">Guides</a>
            </li>
            <li>
                <a href="/docs/tech-blogs/">Articles & Blogs</a>
            </li>
            <li>
                <a href="/docs/videos/">Videos</a>
            </li>
            <li>
                <a href="/docs/about/">About</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/company/startech-enterprises/">LinkedIn</a>
            </li>
            <li style="color: #e82127;">
                <span class="icon">
                    <span> <i class="fas fa-star"></i></span>
                </span>Star Base 2020
            </li>
        </ul>
    </footer>
</div>
<!-- end of / footerContainer -->
	</body>
		<!-- Reference to main JavaScript Files -->
<script src="/../docs/assets/js/library.js" type="application/javascript"></script>
<script src="/../docs/assets/js/breadCrumb.js" type="application/javascript"></script>
<script src="/../docs/assets/js/navbar.js" type="application/javascript"></script>
<script src="/../docs/assets/js/affix.js" type="application/javascript"></script>
<script src="/../docs/assets/js/rhsToc.js" type="application/javascript"></script>


    <script src="/../docs/assets/js/lhsTree.js" type="application/javascript"></script>
    <script src="/../docs/assets/js/searchFilter.js" type="application/javascript"></script>


<script src="/../docs/assets/js/scrollTop.js" type="application/javascript"></script>
<script src="/../docs/assets/js/gitFeedback.js" type="application/javascript"></script>
<script src="/../docs/assets/js/copyCode.js" type="application/javascript"></script>
</html>
