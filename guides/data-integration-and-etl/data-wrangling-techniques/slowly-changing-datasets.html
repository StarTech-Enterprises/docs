<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176158185-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176158185-1');
</script>

		<title>Dealing with slowly changing Datasets | StarBase </title>
		<!-- link to website tab icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/../docs/assets/images/alt-logo-star-tilted.png" />
		<!-- link to Main Stylesheets -->
		<link rel="stylesheet" type="text/css" href="/../docs/assets/css/styles.css">
		<!-- link to Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Zilla Slab' rel='stylesheet'>
		<link href="https://fonts.googleapis.com/css2?family=Marcellus&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300..400&display=swap" rel="stylesheet">
		<!-- link to Font awesome -->
		<script src="https://kit.fontawesome.com/378306bc97.js" crossorigin="anonymous"></script>
		<!-- link to Material Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- link to Iconify CDN -->
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<!-- link to UUID -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv5.min.js"></script>
	</head>
	<body>
		<a id="top"></a>
			<!-- Header Holder --> 

<div class="header-holder has-default-focus"  >
    <div class="nav-bar">
        <!---->
        <a class="nav-bar-button has-padding-left-medium has-padding-left-none-tablet" href="https://sachin1882.wixsite.com/startechenterprises/guides" title="Go to parent site: StarTech Enterprises">
            <div class="nav-bar-logo has-background-image">
                <img src="https://fontmeme.com/permalink/200623/587d8aec23ed76c10e0b1ec43bc85f23.png" class="alt-logo has-background-image" width="180" height ="70">
                <div class="overlay">
                    <img src="/../docs/assets/images/starbase_logo.png" class="nav-bar-logo">
                </div>
            </div>
        </a>
        <nav class="nav-bar-nav">
            <ul class="nav-bar-nav-list">
                <li class="nav-bar-item is-category has-spacing">
                    <a class = "nav-bar-button title has-hover-underline is-6" href="/docs/">
                        <span>
                            <!---->
                            Docs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/">
                        <span>
                            <!---->
                            Guides
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/articles-and-blogs/article-search.html">
                        <span>
                            <!---->
                            Articles & Blogs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/videos/">
                        <span>
                            <!---->
                            Videos
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/about/">
                        <span>
                            <!---->
                            About
                            <!---->
                        </span>
                    </a>
                </li>
            </ul>
        </nav>
        <span class = "nav-bar-spacer i-hidden-mobile"></span>
        <!---->
    </div>
    
    <div class="content-header uhf-container has-padding has-default-focus has-border-bottom-none is-flexbox">
        
<!-- Get correct Breadcrumb Links from Front Matter of loaded page-->

<!-- Liquid Code -->
    <!-- Page Root -->
    

    <!-- Page Type -->
    

    <!-- Page Category -->
    

    <!-- Page Series -->
    
<!-- / End of Liquid Code -->


<!-- Breadcrumb Links --> 
<nav class = "has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow">
    <ul id="page-breadcrumbs" class="breadcrumbs">
        <li><a href="/docs/"><span class ="">Docs</span></a></li>
        <li><a href="/docs/"><span class ="">Guides</span></a></li>
        <li><a href="/docs/guides/data-integration-and-etl/etl.html"><span class="">Data Integration & ETL</span></a></li>
        <li><a href=/docs/guides/data-integration-and-etl/data-wrangling-techniques/introduction.html><span class="">Data Wrangling Techniques</span></a></li>

        <!-- This part needs to be generated by JavaScript-->

    </ul>
</nav>
<!-- end of / Breadcrumb links -->




        <!-- Page Functions --> 

<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
    <ul class="is-hidden-mobile action-list has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
        <li>
            <button class="print button is-text has-inner-focus is-small is-icon-only-touch colorfill" type="button" title="Print this page" onclick="window.print()">
                <span class="icon">
                    <span class="iconify extra-small" data-icon="el:print" data-inline="false"></span>                </span>
                <span class="is-visually-hidden-touch is-hidden-portrait">Print</span>
            </button>
        </li>
        <li>
            <button class="button is-text has-inner-focus is-small is-icon-only-touch colorfill" title="Send feedback about this page" onclick="location.href='#feedback'">
                <span class="icon">
                    <i class="fas fa-comments"></i>
                </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
            </button>
        </li>
        <li id="share-menu-link">
            <div class = "sharing dropdown has-caret">
                <button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch colorfill" title="Share This Document">
                    <span class="icon">
                        <span class="iconify extra-small" data-icon="ls:share" data-inline="false"></span>
                    </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
                </button>
                <div id="sharing-menu" class="sharing-menu has-padding-small is-hidden">
                    <ul>
                        <li id="twitter-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-twitter colorfill"></i>
                                </span>
                                <span>Twitter</span>
                            </a>
                        </li>
                        <li id="linkedin-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-linkedin-in colorfill"></i>
                                </span>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li id="facebook-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-facebook-f colorfill"></i>
                                </span>
                                <span>Facebook</span>
                            </a>
                        </li>
                        <li id="email-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fas fa-envelope colorfill"></i>
                                </span>
                                <span>Email</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ul>
</div>

<!-- end of / Page Functions -->
    </div>
    
</div>

<!-- end of /.header-holder -->
			<!-- Main Container --> 
<div class="mainContainer uhf-container  has-top-padding ">
    <div class="columns has-large-gaps is-gapless-mobile ">

        
        <!-- Left Hand Side Tree-->
        <div class="left-sidebar column is-hidden-mobile  is-one-third-tablet is-one-quarter-desktop ">
            <nav class ="is-fixed is-flex is-flex-column" id="affixed-left-sidebar">

                <!-- Include LHS Menu -->
                
                <form class = "has-margin-bottom-small" action="javascript:" role="search">
                    <label class="visually-hidden">Search</label>
                    <div class="searchFilter is-block">
                        <div class="control has-icons-left">
                            <input id="searchFilter" class="searchFilter-input input control has-icons-left is-full-width is-small" role="combobox" maxlength="100" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" placeholder="Filter by title" type="text">
                            <span class="icon is-small is-left">
                                <img src="/../docs/assets/images/filter.png" class="filter-icon">
                            </span>
                        </div>
                        <ul class="searchFilter-suggestions is-vertically-scrollable is-hidden"></ul>
                    </div>
                </form>

                <ul class="toc is-vertically-scrollable has-flex-grow has-flex-shrink">
                    <!-- Menu Series -->
                    
                    
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/introduction.html">Introduction</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/mismatched-tables.html">Mismatched Tables</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/preserving-context.html">Preserving Context</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/data-into-tables.html">Transforming Data into Tables</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/generalised-unpivoting.html">Generalised unpivoting</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/generalisable-function.html">Creating a Generalisable function</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/slowly-changing-datasets.html">Dealing with slowly changing Datasets</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/the-challenge.html">The Challenge! - combining revenue files</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/data-wrangling-techniques/data-cop.html">Data Cop! - detecting revenue changes</a></li>
    
          
        
      </li>
  
</ul>
                </ul>

                <!-- Include the Correct Back Button -->
                
            </nav>
        </div>
         <!-- end of /left hand side tree -->
        

        <!-- Primary Holder -->    
        <div class="primary-holder column 
          
        is-two-thirds-tablet is-three-quarters-desktop 
        ">
            <div class="columns has-large-gaps is-gapless-mobile 
            
            ">

                 <!-- Main Column -->
                <div id="main-column" class="column 
                 
                is-full is-four-fifths-desktop 
                ">
                    <main id="main" class ="
                    
                        content
                    " lang="eng-us">
                        <h1 id="dealing-with-slowly-changing-datasets">Dealing with slowly changing Datasets</h1>
<time class="metadata" style="text-alstyleign:left"> Guides • Data Integration &amp; ETL • 23/06/2019</time>

<h2 id="overview">Overview</h2>

<p>Trying to maintain a reporting system that lasts longer than its data can sometimes be a never-ending battle!</p>

<p>This article provides some tips to help you thinking differently about ETL, when it comes to ‘<em>slowly changing</em>’ datasets (those whose structure slowly changes over time)</p>

<h2 id="tip-1-define-a-data-contract">Tip 1: Define a Data Contract</h2>

<p>Perhaps, one of the best things to do, with a slowly changing dataset, is to define a <strong><em>data contract</em></strong> with the original data owner. This is so that whenever the structure of the dataset source (names of columns, new columns, etc.) changes, you are notified in good time.</p>

<p>Being a true <em>“Business Partner”</em> – and demonstrating a “warm”, and “wholesome” ability to collaborate with your work colleagues can be a very good feeling!</p>

<h2 id="tip-2-filtering-columns">Tip 2: Filtering columns</h2>

<p>Be particularly careful when using filters, ensuring that any filtering logic you create, is created as expected.</p>

<p>So, watch out for when a generated filter favours the positive condition, using the equal sign on items you have selected, and, when it favours a negative condition, using a not equal sign, on the items you haven’t selected.</p>

<p>If the items listed in the filtered column changes, both types of filtering logic can give slightly different results. For example a column that has just two items {red, yellow}, whilst a filter that does item = red, and a filter that does item &lt;&gt; yellow will yield the same results now, they will not when or if more colors appear in the column.</p>

<p>So, think about what future values might appear or disappear in the filtered column, when or if new items appear in it. How can you make your filtering logic more robust to better handle this?</p>

<h2 id="tip-3-re-ordering-columns">Tip 3: Re-ordering columns</h2>

<p>Often, in ETLs, you are not concerned about the exact order of columns but would like to apply a specific order to a small subset of columns.</p>

<p>By default, in power query, when you reorder columns, the <strong><em>Table.ReorderColumns</em></strong> function is called with a reference to all the columns in the table. Referencing all columns can weaken an ETL and increase the chances of future refresh failures, when / if columns are renamed or removed from the source.</p>

<p>The advice here is to re-order only on the columns you want to keep. So, avoid loading hundreds of columns, re-ordering all of them, and only keeping a few. This non-targeted approach can involve a lot of wasteful operations, and also waste valuable processing power.</p>

<p>Also, if re-ordering is needed, it is better to apply it after you keep only the columns needed in the report</p>

<p><strong><em>Re-order columns dynamically (with code!)</em></strong></p>

<p>For example:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Table.ReorderColumns (
	#”TableStep”,
	List.InsertRange (
		List.Difference(
			Table.ColumnNames(#”TableStep”),
			{“Customers”, “Employees”}
		),
		1,
		{“Customers”, “Employees”}
	)
)
">
  </button>
</div>
<pre><code class="language-powerquery-m">Table.ReorderColumns (
	#”TableStep”,
	List.InsertRange (
		List.Difference(
			Table.ColumnNames(#”TableStep”),
			{“Customers”, “Employees”}
		),
		1,
		{“Customers”, “Employees”}
	)
)
</code></pre>

<p>The above code will dynamically take any table as input, (e.g. #”TableStep”), and re-order the columns called <em>“Customers”</em>, and <em>“Employees”</em>, into the 2nd and 3rd positions - regardless of how many other columns there are in the table, and what these columns are named.</p>

<p>With the above completed, you can then take things a step further by turning the code into a repeatable function, like so:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
fnReorderSubsetOfColumns =
(tbl as table, reorderedcolumns as list, offset as number) as table =&gt;
Table.ReorderColumns (
	tbl,
	List.InsertRange (
		List.Difference(
			Table.ColumnNames(tbl),
			reorderedcolumns
		),
		offset,
		reorderedColumns
	)
)
">
  </button>
</div>
<pre><code class="language-powerquery-m">fnReorderSubsetOfColumns =
(tbl as table, reorderedcolumns as list, offset as number) as table =&gt;
Table.ReorderColumns (
	tbl,
	List.InsertRange (
		List.Difference(
			Table.ColumnNames(tbl),
			reorderedcolumns
		),
		offset,
		reorderedColumns
	)
)
</code></pre>

<p>Once a function has been created, you can call the function again on a different table, like so:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
fnReorderSubsetOfColumns = (#”TableStepNew”, {“Suppliers”, “Stores”}, 1)
">
  </button>
</div>
<pre><code class="language-powerquery-m">fnReorderSubsetOfColumns = (#”TableStepNew”, {“Suppliers”, “Stores”}, 1)
</code></pre>

<h2 id="tip-4-removing-columns">Tip 4: Removing columns</h2>

<p>Generally speaking, when selecting columns, to reduce the risk of an ETL refresh failure, it is better to focus on the columns you want to keep, than on the ones you want to remove.</p>

<p>For example, if the data source owner decides to remove certain columns themselves, and your ETL also has steps for removing these columns – the ETL will likely to fail on its next refresh. Having an ETL that keeps the columns you want, tends to avoid these problems.</p>

<p>It can also be better to remove (or select) columns based on their position rather than name.</p>

<p>The following functions can help you remove and/or select columns in a more dynamic way, and avoid hard-coded name references where possible.</p>

<div class="callout callout-danger alerts-font">
  <p><span style="color:#cf2727"><strong><em>List.FirstN</em></strong></span> - <em>based on column position:</em></p>

  <p>Removes the first two columns from a table</p>

  <div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
    Table.RemoveColumns(Source, List.FirstN(Table.ColumnNames(Source), 2))
">
  </button>
</div>
  <pre><code class="language-powerquery-m">    Table.RemoveColumns(Source, List.FirstN(Table.ColumnNames(Source), 2))
</code></pre>

</div>

<div class="callout callout-warning alerts-font">
  <p><span style="color:#e37209"><strong><em>List.Last</em></strong></span> - <em>based on column position:</em></p>

  <p>Removes the last column from a table</p>

  <div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
    Table.RemoveColumns(Source, List.Last(Table.ColumnNames(Source), 1))
">
  </button>
</div>
  <pre><code class="language-powerquery-m">    Table.RemoveColumns(Source, List.Last(Table.ColumnNames(Source), 1))
</code></pre>

</div>

<div class="callout callout-danger alerts-font">
  <p><span style="color:#cf2727"><strong><em>List.Range</em></strong></span> - <em>based on column position:</em></p>

  <p>Keeps the second and third columns only</p>

  <div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
    Table.SelectColumns(Source, List.Range(Table.ColumnNames(Source), 1, 2))
">
  </button>
</div>
  <pre><code class="language-powerquery-m">    Table.SelectColumns(Source, List.Range(Table.ColumnNames(Source), 1, 2))
</code></pre>

</div>

<div class="alert alert-info alerts-font" role="alert">
  <p><i class="fa fa-info-circle"></i> <b>Note: </b>
<strong><em>List.Range</em></strong> receives a list as its first argument, a zero-based offset as its second, and a count of items to return as its third)</p>
</div>

<div class="callout callout-warning alerts-font">
  <p><span style="color:#e37209"><strong><em>Custom Code</em></strong></span> - <em>based on column position:</em></p>

  <p>Selects 2 non-adjacent columns (the 3rd and 6th columns)</p>

  <div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
    Table.SelectColumns(Source, {Table.ColumnNames(Source){2},  Table.ColumnNames(Source){5}})
">
  </button>
</div>
  <pre><code class="language-powerquery-m">    Table.SelectColumns(Source, {Table.ColumnNames(Source){2},  Table.ColumnNames(Source){5}})
</code></pre>

</div>

<div class="callout callout-danger alerts-font">
  <p><span style="color:#cf2727"><strong><em>List.Select</em></strong></span> - <em>based on column name:</em></p>

  <p>The below example removes columns based on their names rather than positions – removing only those columns whose header contains the substring <em>“Random”</em>.</p>

  <div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
    = Table.RemoveColumns(#”Source”, List.Select(Table.ColumnNames(#”Source”), each Text.Contains (_, “Random”)))
">
  </button>
</div>
  <pre><code class="language-powerquery-m">    = Table.RemoveColumns(#”Source”, List.Select(Table.ColumnNames(#”Source”), each Text.Contains (_, “Random”)))
</code></pre>

  <p>Here, you get the same results using <strong><em>Table.SelectColumns</em></strong>, and with the logic reversed:</p>

  <div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
    = Table.SelectColumns(#”Source”, List.Select(Table.ColumnNames(#”Source”), each not Text.Contains (_, “Random”)))
">
  </button>
</div>
  <pre><code class="language-powerquery-m">    = Table.SelectColumns(#”Source”, List.Select(Table.ColumnNames(#”Source”), each not Text.Contains (_, “Random”)))
</code></pre>

</div>

<h2 id="tip-5-renaming-columns">Tip 5: Renaming columns</h2>

<p>Renaming columns can be a common data preparation step and can improve the user experience. It does however need to be done carefully, as it can result in ETL refresh failures, if, for example, the column names in the source data changes.</p>

<p><strong><em><u>What not to do!</u></em></strong></p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

    Table.RenameColumns(#”Source”, {{“Random Column 1”, “New Name 1”}, {“Random Column 2”, “New Name 2”}})

">
  </button>
</div>
<pre><code class="language-powerquery-m">
    Table.RenameColumns(#”Source”, {{“Random Column 1”, “New Name 1”}, {“Random Column 2”, “New Name 2”}})

</code></pre>

<p>If these columns disappear from the source, the ETL will fail.</p>

<p><strong><em><u>What to do!</u></em></strong></p>

<p>Using functions can be a better way of renaming columns:</p>

<h3 id="create-a-renaming-function">Create a Renaming function</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
fnRenameColumnByIndices =

let
Source = (Source as table, ColumnNamesNew as list, Indices as list) =&gt;
let
    ColumnNamesOld = List.Transform(Indices, each Table.ColumnNames(Source){_} ), 
    ZippedList = List.Zip( { ColumnNamesOld, ColumnNamesNew } ),
    #&quot;Renamed Columns&quot; = Table.RenameColumns(Source, ZippedList)
in
    #&quot;Renamed Columns&quot;
in
    Source
">
  </button>
</div>
<pre><code class="language-powerquery-m">fnRenameColumnByIndices =

let
Source = (Source as table, ColumnNamesNew as list, Indices as list) =&gt;
let
    ColumnNamesOld = List.Transform(Indices, each Table.ColumnNames(Source){_} ), 
    ZippedList = List.Zip( { ColumnNamesOld, ColumnNamesNew } ),
    #"Renamed Columns" = Table.RenameColumns(Source, ZippedList)
in
    #"Renamed Columns"
in
    Source
</code></pre>

<p>The above function takes in three arguments: <em>Source</em> – the Table whose columns you want to rename; <em>ColumnNewNames</em> - for the list of new column names; and <em>Indices</em> - for the list of index positions of the columns in the source table that you wish to rename</p>

<h3 id="invoke-the-renaming-function">Invoke the Renaming function</h3>

<p>Even when invoking a function, you can use generate functions like <strong><em>List.Transform</em></strong> to create dynamic input lists.</p>

<p>For example, when invoking the earlier created function, you can write the following:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
(#&quot;TableStep&quot;, List.Transform({1..7}, each &quot;New Column Name &quot; &amp; Text.From(_)), {6..12})
">
  </button>
</div>
<pre><code class="language-powerquery-m">(#"TableStep", List.Transform({1..7}, each "New Column Name " &amp; Text.From(_)), {6..12})
</code></pre>

<p>This is effective shorthand for:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
fnRenameColumnsByIndices = 
(#&quot;TableStep&quot;, {&quot;New Column Name 1&quot;, &quot; New Column Name 2&quot;, &quot; New Column Name 3&quot;, &quot; New Column Name 4&quot;,&quot; New Column Name 5&quot;, &quot; New Column Name 6&quot;,&quot; New Column Name 7&quot;}, {6..12})
">
  </button>
</div>
<pre><code class="language-powerquery-m">fnRenameColumnsByIndices = 
(#"TableStep", {"New Column Name 1", " New Column Name 2", " New Column Name 3", " New Column Name 4"," New Column Name 5", " New Column Name 6"," New Column Name 7"}, {6..12})
</code></pre>

<p>Other variants of this can also be used!</p>

<div class="alert alert-info alerts-font" role="alert">
  <p><i class="fa fa-info-circle"></i> <b>Note: </b>
‘M’ code has a whole range of <strong>List</strong>, <strong>Record</strong>, <strong>Table</strong> and <strong>Text</strong> functions that you can learn more about here:</p>

  <ul>
    <li><a href="https://docs.microsoft.com/en-us/powerquery-m/list-functions" target="_blank">List Functions</a></li>
    <li><a href="https://docs.microsoft.com/en-us/powerquery-m/record-functions" target="_blank">Record Functions</a></li>
    <li><a href="https://docs.microsoft.com/en-us/powerquery-m/table-functions" target="_blank">Table Functions</a></li>
    <li><a href="https://docs.microsoft.com/en-us/powerquery-m/text-functions" target="_blank">Text Functions</a></li>
  </ul>
</div>

<h2 id="tip-6-splitting-columns">Tip 6: Splitting columns</h2>

<p>Incorrectly splitting columns can sometimes lead to missed data. This can happen, for example, when you apply the “Split Column by Delimiter”, on columns, on “delimiter separated values” that have a varying number of elements.</p>

<p>So, for exampe, if row 1, had two elements like this {“green”, “yellow”}, and row 2 had 3 elements like this {“red”, “blue”, “green”}, and the column was split into only two columns, you would lose the element “green”, from row 2.</p>

<p>A better way can be to split the column into rows, rather than into multiple columns.</p>

<p>So, instead of using code like this:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

#&quot;Split Column by Delimiter&quot; = Table.SplitColumn(#&quot;PreviousStep&quot;, &quot;Products&quot;, Splitter.SplitTextByDelimiter(&quot;,&quot;, QuoteStyle.Csv), {&quot;Product.1&quot;, &quot;Product.2&quot;}),

">
  </button>
</div>
<pre><code class="language-powerquery-m">
#"Split Column by Delimiter" = Table.SplitColumn(#"PreviousStep", "Products", Splitter.SplitTextByDelimiter(",", QuoteStyle.Csv), {"Product.1", "Product.2"}),

</code></pre>

<p><em>(the name of the column that needs to be split is called “Products”)</em></p>

<p>You should use the following kind of code:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

#&quot;Split Column by Delimiter&quot; = Table.ExpandListColumn(Table.TransformColumns(#&quot;PreviousStep&quot;, {{&quot;Products&quot;, Splitter.SplitTextByDelimiter(&quot;, &quot;, QuoteStyle.Csv), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), &quot;Products&quot;),

">
  </button>
</div>
<pre><code class="language-powerquery-m">
#"Split Column by Delimiter" = Table.ExpandListColumn(Table.TransformColumns(#"PreviousStep", {{"Products", Splitter.SplitTextByDelimiter(", ", QuoteStyle.Csv), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), "Products"),

</code></pre>

<p>This will split all the elements into new rows, and importantly, ensure none of the information is lost.</p>

<h2 id="tip-7-merging-columns">Tip 7: Merging columns</h2>

<p>As with Splitting Columns, you can apply similar logic and techniques when you have to Merge columns.</p>

<p>Such code can scale your search query to merge a given list of columns, without referencing any hard-coded column names – like shown in the example below, which merges columns based on an input list of column names:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
#”Merged Columns” = Table.CombineColumns (
	Table.TransformColumnTypes (
		Source,
		List.Transform (
			ColumnsToMerge,
			each {_, type text}
		),
		“en-US”
	),
	ColumnsToMerge,
Combiner.CombineTextByDelimiter(“:”, QuoteStyle.None),
“Merged”)
">
  </button>
</div>
<pre><code class="language-powerquery-m">#”Merged Columns” = Table.CombineColumns (
	Table.TransformColumnTypes (
		Source,
		List.Transform (
			ColumnsToMerge,
			each {_, type text}
		),
		“en-US”
	),
	ColumnsToMerge,
Combiner.CombineTextByDelimiter(“:”, QuoteStyle.None),
“Merged”)
</code></pre>

<p><em>(the list of column names to merge is contained in the list called “ColumnsToMerge”)</em></p>

<h2 id="tip-8-changing-data-types">Tip 8: Changing Data types</h2>

<p>Data types are a big deal in computer science and computer programming! You may have heard of things such as: type casting, type conversion, or strongly typed - these all refer to the type of a particular variable (i.e. whether an integer, decimal, date, string, etc.)</p>

<p>Power Query has a useful feature, where you can set the data type of each field or column. Whenever you launch a new query, for example, you will often see a step called <em>“Changed Type”</em> appear, under the Applied Steps section. This is Power Query using its own algorithms to try and set the data type of each column.</p>

<p>Whilst it can be helpful for it to automatically do this for you, it can get quite annoying, especially as the <em>“Changed Type”</em> step should be kept as far down the ETL chain as possible (as column data types are changed by reference to their hard-coded name, rather than position).</p>

<p>As a rule of thumb, the <em>“Changed Type”</em> step, should appear:</p>

<ul>
  <li>Only once, in any given query</li>
  <li>As far down the query chain as possible</li>
</ul>

<p>Whilst, it might seem like a good idea to get rid of the step altogether, we wouldn’t recommend it. Setting data types can be very helpful in detecting inadvertent errors in your data (e.g. data of the wrong data type), such as: invalid dates, invalid numbers, and so on. This kind of checking would be very hard, almost impossible to do otherwise!</p>

<h2 id="see-also">See also</h2>

<ul>
  <li><strong>ETL Best Practices</strong>: a selection of good practices to follow with ETL when designing and building data queries <a href="../starting-with-etl/best-practices.html">» Read more</a></li>
  <li><strong>Transforming Data</strong>: a selection articles on how to perform basic ETL transformations, such as: renaming, re-ordering, removing, splitting, and merging of columns <a href="../starting-with-etl/reordering-columns.html">» Read more</a></li>
</ul>

                        
                            <div id="mainNavBottom">
    <a class="no_icon" href="">
        <span id="previousPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-back" data-inline="false"></span>
        </span>
    </a>
    <a class="no_icon" href="">
        <span id="nextPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-forward" data-inline="false"></span>					
        </span>
    </a>
</div>
                        
                    </main>	
                    
                        <!-- Start of Feedback section -->
<section class="feedback-section is-relative">
    <h2 id="feedback" class="is-size-2 has-margin-top-large has-padding-top-medium"> Feedback </h2>
    <div class="feedback has-margin-top-small has-margin-bottom-none">
        <p id="send-feedback-about" class="has-margin-top-none has-margin-bottom-none">
            Submit and view feedback
        </p>
        <div id="feedback-section-link" class="has-margin-top-large has-margin-bottom-none">
            <a class="button has-margin-bottom-small" href="" target="_blank">
                <span class="icon">
                    <span class=github>
                        <i class="fab fa-github"></i>
                    </span>
                </span>
                <span>This page</span>
            </a>
        </div>
    </div>
    <div id="viewallfeedback-section-link" class="is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-medium">
        <a class="view-on-github" href="" target="_blank">
            <span class="icon">
                <span class=github>
                    <i class="fab fa-github"></i>
                </span>
            </span><span>View all page feedback</span>
        </a>
    </div>
</section>

<!-- End of Feedback section -->
                    
                </div>

                
                 <!-- Right Hand Side Toc-->
                 <div class="right-sidebar column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only">
                    <nav class="doc-outline is-fixed is-vertically-scrollable", id="affixed-right-sidebar">
                        <nav id="side-doc-outline">
                            <header id="side-doc-title" class = "is-flex is-flex-row">
                                <div>
                                    <a href="#top">
                                        <h3 title="Go to Top of Page">
                                            <i class="fas fa-file-alt" style="color:#e82127;">&nbsp;</i>
                                            In this article
                                        </h3>
                                    </a>
                                </div>
                            </header>
                            <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h2"><a href="#tip-1-define-a-data-contract">Tip 1: Define a Data Contract</a></li>
<li class="toc-entry toc-h2"><a href="#tip-2-filtering-columns">Tip 2: Filtering columns</a></li>
<li class="toc-entry toc-h2"><a href="#tip-3-re-ordering-columns">Tip 3: Re-ordering columns</a></li>
<li class="toc-entry toc-h2"><a href="#tip-4-removing-columns">Tip 4: Removing columns</a></li>
<li class="toc-entry toc-h2"><a href="#tip-5-renaming-columns">Tip 5: Renaming columns</a>
<ul>
<li class="toc-entry toc-h3"><a href="#create-a-renaming-function">Create a Renaming function</a></li>
<li class="toc-entry toc-h3"><a href="#invoke-the-renaming-function">Invoke the Renaming function</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#tip-6-splitting-columns">Tip 6: Splitting columns</a></li>
<li class="toc-entry toc-h2"><a href="#tip-7-merging-columns">Tip 7: Merging columns</a></li>
<li class="toc-entry toc-h2"><a href="#tip-8-changing-data-types">Tip 8: Changing Data types</a></li>
<li class="toc-entry toc-h2"><a href="#see-also">See also</a></li>
</ul>
                        </nav>

                        <!-- Fixed Element-->
                        <div>
                            <a class="top-link hide" href="" id="js-top" title="Go to Top of Page">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>
                            </a>
                        </div>
                    </nav>
                </div>
                
            </div>
            <!-- end of /.columns -->
        </div>	
        <!-- end of /primary holder -->

    </div>
    <!-- end of /.columns -->
</div>
<!-- end of /.mainContainer -->
			<!-- Footer Container --> 
<div class="footerContainer">

    
    

    <footer id="footer" class=" footer-layout   uhf-container has-padding">
        <div class="">
            <a href="https://startech-enterprises.github.io/docs/">
                <img src="/../docs/assets/images/starbase_logo.png" class="footer-bar-logo">
            </a>
        </div>
        <div class="is-flex is-full-height has-padding-right-extra-large-desktop has-padding-left-extra-large-desktop">
            <a class="locale-selector-link has-flex-shrink-none" href="/../">
                <span class="icon">
                    <span><i class="fas fa-globe"></i></span>
                </span>
                <span class="locale-selector-link-text">English (United Kingdom)</span>
            </a>
        </div>
        <ul class="links">
            <li>
                <a href="/docs/">Docs</a>
            </li>
            <li>
                <a href="/docs/guides/">Guides</a>
            </li>
            <li>
                <a href="/docs/tech-blogs/">Articles & Blogs</a>
            </li>
            <li>
                <a href="/docs/videos/">Videos</a>
            </li>
            <li>
                <a href="/docs/about/">About</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/company/startech-enterprises/">LinkedIn</a>
            </li>
            <li style="color: #e82127;">
                <span class="icon">
                    <span> <i class="fas fa-star"></i></span>
                </span>Star Base 2020
            </li>
        </ul>
    </footer>
</div>
<!-- end of / footerContainer -->
	</body>
		<!-- Reference to main JavaScript Files -->
<script src="/../docs/assets/js/library.js" type="application/javascript"></script>
<script src="/../docs/assets/js/breadCrumb.js" type="application/javascript"></script>
<script src="/../docs/assets/js/navbar.js" type="application/javascript"></script>
<script src="/../docs/assets/js/affix.js" type="application/javascript"></script>
<script src="/../docs/assets/js/rhsToc.js" type="application/javascript"></script>


    <script src="/../docs/assets/js/lhsTree.js" type="application/javascript"></script>
    <script src="/../docs/assets/js/searchFilter.js" type="application/javascript"></script>


<script src="/../docs/assets/js/scrollTop.js" type="application/javascript"></script>
<script src="/../docs/assets/js/gitFeedback.js" type="application/javascript"></script>
<script src="/../docs/assets/js/copyCode.js" type="application/javascript"></script>
</html>
