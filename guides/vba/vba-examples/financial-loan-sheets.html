<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176158185-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176158185-1');
</script>

		<title>Financial Loan Sheets | StarBase </title>
		<!-- link to website tab icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/../docs/assets/images/alt-logo-star-tilted.png" />
		<!-- link to Main Stylesheets -->
		<link rel="stylesheet" type="text/css" href="/../docs/assets/css/styles.css">
		<!-- link to Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Zilla Slab' rel='stylesheet'>
		<link href="https://fonts.googleapis.com/css2?family=Marcellus&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300..400&display=swap" rel="stylesheet">
		<!-- link to Font awesome -->
		<script src="https://kit.fontawesome.com/378306bc97.js" crossorigin="anonymous"></script>
		<!-- link to Material Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- link to Iconify CDN -->
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<!-- link to UUID -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv5.min.js"></script>
	</head>
	<body>
		<a id="top"></a>
			<!-- Header Holder --> 

<div class="header-holder has-default-focus"  >
    <div class="nav-bar">
        <!---->
        <a class="nav-bar-button has-padding-left-medium has-padding-left-none-tablet" href="https://sachin1882.wixsite.com/startechenterprises/guides" title="Go to parent site: StarTech Enterprises">
            <div class="nav-bar-logo has-background-image">
                <img src="https://fontmeme.com/permalink/200623/587d8aec23ed76c10e0b1ec43bc85f23.png" class="alt-logo has-background-image" width="180" height ="70">
                <div class="overlay">
                    <img src="/../docs/assets/images/starbase_logo.png" class="nav-bar-logo">
                </div>
            </div>
        </a>
        <nav class="nav-bar-nav">
            <ul class="nav-bar-nav-list">
                <li class="nav-bar-item is-category has-spacing">
                    <a class = "nav-bar-button title has-hover-underline is-6" href="/docs/">
                        <span>
                            <!---->
                            Docs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/">
                        <span>
                            <!---->
                            Guides
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/articles-and-blogs/article-search.html">
                        <span>
                            <!---->
                            Articles & Blogs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/videos/">
                        <span>
                            <!---->
                            Videos
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/about/">
                        <span>
                            <!---->
                            About
                            <!---->
                        </span>
                    </a>
                </li>
            </ul>
        </nav>
        <span class = "nav-bar-spacer i-hidden-mobile"></span>
        <!---->
    </div>
    
    <div class="content-header uhf-container has-padding has-default-focus has-border-bottom-none is-flexbox">
        
<!-- Get correct Breadcrumb Links from Front Matter of loaded page-->

<!-- Liquid Code -->
    <!-- Page Root -->
    

    <!-- Page Type -->
    

    <!-- Page Category -->
    

    <!-- Page Series -->
    
<!-- / End of Liquid Code -->


<!-- Breadcrumb Links --> 
<nav class = "has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow">
    <ul id="page-breadcrumbs" class="breadcrumbs">
        <li><a href="/docs/"><span class ="">Docs</span></a></li>
        <li><a href="/docs/"><span class ="">Guides</span></a></li>
        <li><a href="/docs/guides/vba/vba.html"><span class="">VBA</span></a></li>
        <li><a href=/docs/guides/vba/vba-examples/overview.html><span class="">VBA - Examples</span></a></li>

        <!-- This part needs to be generated by JavaScript-->

    </ul>
</nav>
<!-- end of / Breadcrumb links -->




        <!-- Page Functions --> 

<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
    <ul class="is-hidden-mobile action-list has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
        <li>
            <button class="print button is-text has-inner-focus is-small is-icon-only-touch colorfill" type="button" title="Print this page" onclick="window.print()">
                <span class="icon">
                    <span class="iconify extra-small" data-icon="el:print" data-inline="false"></span>                </span>
                <span class="is-visually-hidden-touch is-hidden-portrait">Print</span>
            </button>
        </li>
        <li>
            <button class="button is-text has-inner-focus is-small is-icon-only-touch colorfill" title="Send feedback about this page" onclick="location.href='#feedback'">
                <span class="icon">
                    <i class="fas fa-comments"></i>
                </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
            </button>
        </li>
        <li id="share-menu-link">
            <div class = "sharing dropdown has-caret">
                <button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch colorfill" title="Share This Document">
                    <span class="icon">
                        <span class="iconify extra-small" data-icon="ls:share" data-inline="false"></span>
                    </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
                </button>
                <div id="sharing-menu" class="sharing-menu has-padding-small is-hidden">
                    <ul>
                        <li id="twitter-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-twitter colorfill"></i>
                                </span>
                                <span>Twitter</span>
                            </a>
                        </li>
                        <li id="linkedin-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-linkedin-in colorfill"></i>
                                </span>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li id="facebook-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-facebook-f colorfill"></i>
                                </span>
                                <span>Facebook</span>
                            </a>
                        </li>
                        <li id="email-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fas fa-envelope colorfill"></i>
                                </span>
                                <span>Email</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ul>
</div>

<!-- end of / Page Functions -->
    </div>
    
</div>

<!-- end of /.header-holder -->
			<!-- Main Container --> 
<div class="mainContainer uhf-container  has-top-padding ">
    <div class="columns has-large-gaps is-gapless-mobile ">

        
        <!-- Left Hand Side Tree-->
        <div class="left-sidebar column is-hidden-mobile  is-one-third-tablet is-one-quarter-desktop ">
            <nav class ="is-fixed is-flex is-flex-column" id="affixed-left-sidebar">

                <!-- Include LHS Menu -->
                
                <form class = "has-margin-bottom-small" action="javascript:" role="search">
                    <label class="visually-hidden">Search</label>
                    <div class="searchFilter is-block">
                        <div class="control has-icons-left">
                            <input id="searchFilter" class="searchFilter-input input control has-icons-left is-full-width is-small" role="combobox" maxlength="100" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" placeholder="Filter by title" type="text">
                            <span class="icon is-small is-left">
                                <img src="/../docs/assets/images/filter.png" class="filter-icon">
                            </span>
                        </div>
                        <ul class="searchFilter-suggestions is-vertically-scrollable is-hidden"></ul>
                    </div>
                </form>

                <ul class="toc is-vertically-scrollable has-flex-grow has-flex-shrink">
                    <!-- Menu Series -->
                    
                    
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/overview.html">Introduction</a></li>
    
          
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Data Integration</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/data-integration.html">Data Integration</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/word-form-to-excel-table.html">Word Form to Excel Table</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/excel-form-to-excel-sheet.html">Excel Form to Excel Sheet</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/excel-form-to-excel-table.html">Excel Form to Excel Table</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/mysql-to-excel-table-1.html">MySQL to Excel Table - Ex. 1</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/mysql-to-excel-table-2.html">MySQL to Excel Table - Ex. 2</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/excel-table-to-mysql.html">Excel Table(s) to MySQL</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Automating Tasks & Calculations</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/bulk-refreshing.html">Bulk Refreshing workbooks</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/adding-data-and-comparing-lists.html">Adding Data & Comparing Lists</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/financial-loan-sheets.html">Financial Loan Sheets</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/locking-sheets.html">Locking Sheets</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Data from External Datasets</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/data-from-quandl.html">Getting Data from Quandl</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Custom Functions</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/custom-vba-functions.html">Custom VBA Functions</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>WorkBook Navigation</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/creating-a-toc.html">Creating a ToC</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/guide-references.html">Guide References</a></li>
    
          
        
      </li>
  
</ul>
                </ul>

                <!-- Include the Correct Back Button -->
                
            </nav>
        </div>
         <!-- end of /left hand side tree -->
        

        <!-- Primary Holder -->    
        <div class="primary-holder column 
          
        is-two-thirds-tablet is-three-quarters-desktop 
        ">
            <div class="columns has-large-gaps is-gapless-mobile 
            
            ">

                 <!-- Main Column -->
                <div id="main-column" class="column 
                 
                is-full is-four-fifths-desktop 
                ">
                    <main id="main" class ="
                    
                        content
                    " lang="eng-us">
                        <h1 id="financial-loan-sheets">Financial Loan Sheets</h1>
<time class="metadata" style="text-alstyleign:left"> Guides • VBA • 12/01/2021</time>

<p>Here we show how it might be useful to use VBA to complete two different kinds of financial loan sheets, including the accrued interest and principal balances, either at the end of each month, or some financial event, such as a payment or drawdown.</p>

<h2 id="screenshots">Screenshots</h2>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-loan-sheets-01.png');" src="images/financial-loan-sheets-01.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Loan 1</i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-loan-sheets-02.png');" src="images/financial-loan-sheets-02.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Loan 2</i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<figure>
    
        <img class="docimage" src="images/financial-loan-sheets-03.png" alt="" style="width: 100%; max-width: 39.6%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Interest Rates</i>
    </figcaption>
    
</figure>
<figure>
    
        <img class="docimage" src="images/financial-loan-sheets-04.png" alt="" style="width: 100%; max-width: 69.2%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Password</i>
    </figcaption>
    
</figure>

<!-- ************************************************ -->

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <div class="modal-header">
      <h4>VBA - Financial Loan Sheets</h4>
      <p><span class="close">
×
</span></p>
    </div>
    <div class="modal-body">
      <!-- image inserted with JavaScript -->
    </div>
    <div class="modal-footer"></div>
  </div>
</div>

<!-- ************************************************ -->

<h2 id="vba-module-code--loan-1">VBA Module Code – Loan 1</h2>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: VBA">VBA</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

Sub UpdateLoan1()

Dim pswdSheet As String
pswdSheet = Sheets(&quot;Pwd&quot;).Cells(2, 1)

ActiveSheet.Unprotect Password:=pswdSheet
ActiveSheet.Protect UserInterfaceOnly:=True

Dim wb As Workbook
Dim sh As Worksheet
Dim tblwidth As Long
Dim tblheight As Long
Dim rng As Range
Dim rng2 As Range

Dim VariableInterest As Long

    &#39;Initialize Excel Objects
    Set wbBook = ThisWorkbook
    With wbBook
    Set sh1 = .Worksheets(&quot;Loan 1&quot;)
    Set sh2 = .Worksheets(&quot;2M LIBOR&quot;)
    End With

    &#39;Go to first non-empty cell in Column A (where the Table should be)
    sh1.Activate
    With Columns(&quot;A&quot;)
    .Find(what:=&quot;*&quot;, after:=.Cells(1, 1), LookIn:=xlValues).Activate
    End With
    
    &#39;Select the Table region and define table width and height
    Set tbl = ActiveCell.CurrentRegion
    &#39;tbl.Offset(1, 0).Resize(tbl.Rows.Count - 1, tbl.Columns.Count).Select
    tblwidth = tbl.Columns.Count - 1
    tblheight = tbl.Rows.Count - 1
    
    &#39;Copy Formulae from last row in Table to next row
    With sh1
    Set rng = .Range(.Cells(ActiveCell.Offset(tblheight, 1).Row, ActiveCell.Offset(tblheight, 1).Column), .Cells(ActiveCell.Offset(tblheight, tblwidth).Row, ActiveCell.Offset(tblheight, tblwidth).Column))
    rng.Copy
    Set rng2 = rng.Offset(1, 0)
    rng2.PasteSpecial Paste:=xlPasteFormulas
    End With
    
    &#39;Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts
    sh1.Activate
    With Columns(&quot;A&quot;)
    .Find(what:=&quot;*&quot;, after:=.Cells(1, 1), LookIn:=xlValues).Activate
    End With
    
    &#39;Ensure End Date in new row still shows EoMonth Formula
    ActiveCell.Offset(1, 2).Copy
    ActiveCell.Offset(tblheight + 1, 2).PasteSpecial Paste:=xlPasteFormulas
    
    &#39;Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts
    sh1.Activate
    With Columns(&quot;A&quot;)
    .Find(what:=&quot;*&quot;, after:=.Cells(1, 1), LookIn:=xlValues).Activate
    End With
    
    &#39;Clear anything that may have been copied down in the Cash and Drawdown Colums - as these are manually entered
    ActiveCell.Offset(tblheight + 1, 6).ClearContents
    ActiveCell.Offset(tblheight + 1, 7).ClearContents
    
    &#39;Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts
    sh1.Activate
    With Columns(&quot;A&quot;)
    .Find(what:=&quot;*&quot;, after:=.Cells(1, 1), LookIn:=xlValues).Activate
    End With
    
    &#39;Interest used for Period
    &#39;Find Variable Interest Rate
    On Error Resume Next
    With sh1
    VariableInterest = Application.WorksheetFunction.EoMonth(ActiveCell.Offset(tblheight + 1, 1), -1) + 1
    ActiveCell.Offset(tblheight + 1, tblwidth + 4).Value = Application.WorksheetFunction.VLookup(CLng(VariableInterest), sh2.Range(&quot;A1:B999&quot;), 2, False)
    End With
    
    &#39;Find Fixed Interest Rate
    ActiveCell.Offset(tblheight + 1, tblwidth + 3).Value = sh1.Range(&quot;c17&quot;).Value
    
    &#39;Calculate Total Interest Rate
    ActiveCell.Offset(tblheight + 1, tblwidth + 2).Value = ActiveCell.Offset(tblheight + 1, tblwidth + 4).Value + ActiveCell.Offset(tblheight + 1, tblwidth + 3).Value

ActiveSheet.Protect Password:=pswdSheet

MsgBox &quot;Loan 1 Done&quot;

End Sub

">
  </button>
</div>
<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">Sub</span> <span class="nf">UpdateLoan1</span><span class="p">()</span>

<span class="k">Dim</span> <span class="nv">pswdSheet</span> <span class="ow">As</span> <span class="kt">String</span>
<span class="n">pswdSheet</span> <span class="o">=</span> <span class="n">Sheets</span><span class="p">(</span><span class="s">"Pwd"</span><span class="p">).</span><span class="n">Cells</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Unprotect</span> <span class="n">Password</span><span class="p">:</span><span class="o">=</span><span class="n">pswdSheet</span>
<span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Protect</span> <span class="n">UserInterfaceOnly</span><span class="p">:</span><span class="o">=</span><span class="k">True</span>

<span class="k">Dim</span> <span class="nv">wb</span> <span class="ow">As</span> <span class="n">Workbook</span>
<span class="k">Dim</span> <span class="nv">sh</span> <span class="ow">As</span> <span class="n">Worksheet</span>
<span class="k">Dim</span> <span class="nv">tblwidth</span> <span class="ow">As</span> <span class="kt">Long</span>
<span class="k">Dim</span> <span class="nv">tblheight</span> <span class="ow">As</span> <span class="kt">Long</span>
<span class="k">Dim</span> <span class="nv">rng</span> <span class="ow">As</span> <span class="n">Range</span>
<span class="k">Dim</span> <span class="nv">rng2</span> <span class="ow">As</span> <span class="n">Range</span>

<span class="k">Dim</span> <span class="nv">VariableInterest</span> <span class="ow">As</span> <span class="kt">Long</span>

    <span class="c1">'Initialize Excel Objects</span>
    <span class="k">Set</span> <span class="n">wbBook</span> <span class="o">=</span> <span class="n">ThisWorkbook</span>
    <span class="k">With</span> <span class="n">wbBook</span>
    <span class="k">Set</span> <span class="n">sh1</span> <span class="o">=</span> <span class="p">.</span><span class="n">Worksheets</span><span class="p">(</span><span class="s">"Loan 1"</span><span class="p">)</span>
    <span class="k">Set</span> <span class="n">sh2</span> <span class="o">=</span> <span class="p">.</span><span class="n">Worksheets</span><span class="p">(</span><span class="s">"2M LIBOR"</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">With</span>

    <span class="c1">'Go to first non-empty cell in Column A (where the Table should be)</span>
    <span class="n">sh1</span><span class="p">.</span><span class="n">Activate</span>
    <span class="k">With</span> <span class="n">Columns</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">what</span><span class="p">:</span><span class="o">=</span><span class="s">"*"</span><span class="p">,</span> <span class="n">after</span><span class="p">:</span><span class="o">=</span><span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LookIn</span><span class="p">:</span><span class="o">=</span><span class="n">xlValues</span><span class="p">).</span><span class="n">Activate</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Select the Table region and define table width and height</span>
    <span class="k">Set</span> <span class="n">tbl</span> <span class="o">=</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">CurrentRegion</span>
    <span class="c1">'tbl.Offset(1, 0).Resize(tbl.Rows.Count - 1, tbl.Columns.Count).Select</span>
    <span class="n">tblwidth</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">tblheight</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
    
    <span class="c1">'Copy Formulae from last row in Table to next row</span>
    <span class="k">With</span> <span class="n">sh1</span>
    <span class="k">Set</span> <span class="n">rng</span> <span class="o">=</span> <span class="p">.</span><span class="n">Range</span><span class="p">(.</span><span class="n">Cells</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">Row</span><span class="p">,</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">Column</span><span class="p">),</span> <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span><span class="p">,</span> <span class="n">tblwidth</span><span class="p">).</span><span class="n">Row</span><span class="p">,</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span><span class="p">,</span> <span class="n">tblwidth</span><span class="p">).</span><span class="n">Column</span><span class="p">))</span>
    <span class="n">rng</span><span class="p">.</span><span class="n">Copy</span>
    <span class="k">Set</span> <span class="n">rng2</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">rng2</span><span class="p">.</span><span class="n">PasteSpecial</span> <span class="n">Paste</span><span class="p">:</span><span class="o">=</span><span class="n">xlPasteFormulas</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts</span>
    <span class="n">sh1</span><span class="p">.</span><span class="n">Activate</span>
    <span class="k">With</span> <span class="n">Columns</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">what</span><span class="p">:</span><span class="o">=</span><span class="s">"*"</span><span class="p">,</span> <span class="n">after</span><span class="p">:</span><span class="o">=</span><span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LookIn</span><span class="p">:</span><span class="o">=</span><span class="n">xlValues</span><span class="p">).</span><span class="n">Activate</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Ensure End Date in new row still shows EoMonth Formula</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">Copy</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">PasteSpecial</span> <span class="n">Paste</span><span class="p">:</span><span class="o">=</span><span class="n">xlPasteFormulas</span>
    
    <span class="c1">'Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts</span>
    <span class="n">sh1</span><span class="p">.</span><span class="n">Activate</span>
    <span class="k">With</span> <span class="n">Columns</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">what</span><span class="p">:</span><span class="o">=</span><span class="s">"*"</span><span class="p">,</span> <span class="n">after</span><span class="p">:</span><span class="o">=</span><span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LookIn</span><span class="p">:</span><span class="o">=</span><span class="n">xlValues</span><span class="p">).</span><span class="n">Activate</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Clear anything that may have been copied down in the Cash and Drawdown Colums - as these are manually entered</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">).</span><span class="n">ClearContents</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">).</span><span class="n">ClearContents</span>
    
    <span class="c1">'Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts</span>
    <span class="n">sh1</span><span class="p">.</span><span class="n">Activate</span>
    <span class="k">With</span> <span class="n">Columns</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">what</span><span class="p">:</span><span class="o">=</span><span class="s">"*"</span><span class="p">,</span> <span class="n">after</span><span class="p">:</span><span class="o">=</span><span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LookIn</span><span class="p">:</span><span class="o">=</span><span class="n">xlValues</span><span class="p">).</span><span class="n">Activate</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Interest used for Period</span>
    <span class="c1">'Find Variable Interest Rate</span>
    <span class="k">On</span> <span class="k">Error</span> <span class="k">Resume</span> <span class="k">Next</span>
    <span class="k">With</span> <span class="n">sh1</span>
    <span class="n">VariableInterest</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">WorksheetFunction</span><span class="p">.</span><span class="n">EoMonth</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tblwidth</span> <span class="o">+</span> <span class="mi">4</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">WorksheetFunction</span><span class="p">.</span><span class="n">VLookup</span><span class="p">(</span><span class="k">CLng</span><span class="p">(</span><span class="n">VariableInterest</span><span class="p">),</span> <span class="n">sh2</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="s">"A1:B999"</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="k">False</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Find Fixed Interest Rate</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tblwidth</span> <span class="o">+</span> <span class="mi">3</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="n">sh1</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="s">"c17"</span><span class="p">).</span><span class="n">Value</span>
    
    <span class="c1">'Calculate Total Interest Rate</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tblwidth</span> <span class="o">+</span> <span class="mi">2</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tblwidth</span> <span class="o">+</span> <span class="mi">4</span><span class="p">).</span><span class="n">Value</span> <span class="o">+</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tblwidth</span> <span class="o">+</span> <span class="mi">3</span><span class="p">).</span><span class="n">Value</span>

<span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Protect</span> <span class="n">Password</span><span class="p">:</span><span class="o">=</span><span class="n">pswdSheet</span>

<span class="n">MsgBox</span> <span class="s">"Loan 1 Done"</span>

<span class="k">End</span> <span class="k">Sub</span>

</code></pre></div></div>

<h2 id="vba-module-code--loan-2">VBA Module Code – Loan 2</h2>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: VBA">VBA</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

Sub UpdateLoan2()

Dim pswdSheet As String
pswdSheet = Sheets(&quot;Pwd&quot;).Cells(2, 1)

ActiveSheet.Unprotect Password:=pswdSheet
ActiveSheet.Protect UserInterfaceOnly:=True


Dim wb As Workbook
Dim sh As Worksheet
Dim tblwidth As Long
Dim tblheight As Long
Dim rng As Range
Dim rng2 As Range

    &#39;Initialize Excel Objects
    Set wbBook = ThisWorkbook
    With wbBook
    Set sh1 = .Worksheets(&quot;Loan 2&quot;)
    Set sh2 = .Worksheets(&quot;2M LIBOR&quot;)
    End With

    &#39;Go to first non-empty cell in Column A (where the Table should be)
    sh1.Activate
    With Columns(&quot;A&quot;)
    .Find(what:=&quot;*&quot;, after:=.Cells(1, 1), LookIn:=xlValues).Activate
    End With
    
    &#39;Select the Table region and define table width and height
    Set tbl = ActiveCell.CurrentRegion
    &#39;tbl.Offset(1, 0).Resize(tbl.Rows.Count - 1, tbl.Columns.Count).Select
    tblwidth = tbl.Columns.Count - 1
    tblheight = tbl.Rows.Count - 1
    
    &#39;Copy Formulae from last row in Table to next row
    With sh1
    Set rng = .Range(.Cells(ActiveCell.Offset(tblheight, 1).Row, ActiveCell.Offset(tblheight, 1).Column), .Cells(ActiveCell.Offset(tblheight, tblwidth).Row, ActiveCell.Offset(tblheight, tblwidth).Column))
    rng.Copy
    Set rng2 = rng.Offset(1, 0)
    rng2.PasteSpecial Paste:=xlPasteFormulas
    End With
    
    &#39;Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts
    sh1.Activate
    With Columns(&quot;A&quot;)
    .Find(what:=&quot;*&quot;, after:=.Cells(1, 1), LookIn:=xlValues).Activate
    End With
    
    &#39;Ensure End Date in new row still shows EoMonth Formula
    ActiveCell.Offset(1, 2).Copy
    ActiveCell.Offset(tblheight + 1, 2).PasteSpecial Paste:=xlPasteFormulas
    
    &#39;Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts
    sh1.Activate
    With Columns(&quot;A&quot;)
    .Find(what:=&quot;*&quot;, after:=.Cells(1, 1), LookIn:=xlValues).Activate
    End With
    
    &#39;Clear anything that may have been copied down in the Cash and Drawdown Colums - as these are manually entered
    ActiveCell.Offset(tblheight + 1, 6).ClearContents
    ActiveCell.Offset(tblheight + 1, 7).ClearContents
    
    &#39;Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts
    sh1.Activate
    With Columns(&quot;A&quot;)
    .Find(what:=&quot;*&quot;, after:=.Cells(1, 1), LookIn:=xlValues).Activate
    End With
    
    &#39;Interest used for Period
    
    &#39;Find Fixed Interest Rate
    ActiveCell.Offset(tblheight + 1, tblwidth + 3).Value = sh1.Range(&quot;c17&quot;).Value
    
    &#39;Calculate Total Interest Rate
    ActiveCell.Offset(tblheight + 1, tblwidth + 2).Value = ActiveCell.Offset(tblheight + 1, tblwidth + 4).Value + ActiveCell.Offset(tblheight + 1, tblwidth + 3).Value

ActiveSheet.Protect Password:=pswdSheet

MsgBox &quot;Loan 2 Done&quot;

End Sub

">
  </button>
</div>
<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">Sub</span> <span class="nf">UpdateLoan2</span><span class="p">()</span>

<span class="k">Dim</span> <span class="nv">pswdSheet</span> <span class="ow">As</span> <span class="kt">String</span>
<span class="n">pswdSheet</span> <span class="o">=</span> <span class="n">Sheets</span><span class="p">(</span><span class="s">"Pwd"</span><span class="p">).</span><span class="n">Cells</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Unprotect</span> <span class="n">Password</span><span class="p">:</span><span class="o">=</span><span class="n">pswdSheet</span>
<span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Protect</span> <span class="n">UserInterfaceOnly</span><span class="p">:</span><span class="o">=</span><span class="k">True</span>


<span class="k">Dim</span> <span class="nv">wb</span> <span class="ow">As</span> <span class="n">Workbook</span>
<span class="k">Dim</span> <span class="nv">sh</span> <span class="ow">As</span> <span class="n">Worksheet</span>
<span class="k">Dim</span> <span class="nv">tblwidth</span> <span class="ow">As</span> <span class="kt">Long</span>
<span class="k">Dim</span> <span class="nv">tblheight</span> <span class="ow">As</span> <span class="kt">Long</span>
<span class="k">Dim</span> <span class="nv">rng</span> <span class="ow">As</span> <span class="n">Range</span>
<span class="k">Dim</span> <span class="nv">rng2</span> <span class="ow">As</span> <span class="n">Range</span>

    <span class="c1">'Initialize Excel Objects</span>
    <span class="k">Set</span> <span class="n">wbBook</span> <span class="o">=</span> <span class="n">ThisWorkbook</span>
    <span class="k">With</span> <span class="n">wbBook</span>
    <span class="k">Set</span> <span class="n">sh1</span> <span class="o">=</span> <span class="p">.</span><span class="n">Worksheets</span><span class="p">(</span><span class="s">"Loan 2"</span><span class="p">)</span>
    <span class="k">Set</span> <span class="n">sh2</span> <span class="o">=</span> <span class="p">.</span><span class="n">Worksheets</span><span class="p">(</span><span class="s">"2M LIBOR"</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">With</span>

    <span class="c1">'Go to first non-empty cell in Column A (where the Table should be)</span>
    <span class="n">sh1</span><span class="p">.</span><span class="n">Activate</span>
    <span class="k">With</span> <span class="n">Columns</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">what</span><span class="p">:</span><span class="o">=</span><span class="s">"*"</span><span class="p">,</span> <span class="n">after</span><span class="p">:</span><span class="o">=</span><span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LookIn</span><span class="p">:</span><span class="o">=</span><span class="n">xlValues</span><span class="p">).</span><span class="n">Activate</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Select the Table region and define table width and height</span>
    <span class="k">Set</span> <span class="n">tbl</span> <span class="o">=</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">CurrentRegion</span>
    <span class="c1">'tbl.Offset(1, 0).Resize(tbl.Rows.Count - 1, tbl.Columns.Count).Select</span>
    <span class="n">tblwidth</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">tblheight</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
    
    <span class="c1">'Copy Formulae from last row in Table to next row</span>
    <span class="k">With</span> <span class="n">sh1</span>
    <span class="k">Set</span> <span class="n">rng</span> <span class="o">=</span> <span class="p">.</span><span class="n">Range</span><span class="p">(.</span><span class="n">Cells</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">Row</span><span class="p">,</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">Column</span><span class="p">),</span> <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span><span class="p">,</span> <span class="n">tblwidth</span><span class="p">).</span><span class="n">Row</span><span class="p">,</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span><span class="p">,</span> <span class="n">tblwidth</span><span class="p">).</span><span class="n">Column</span><span class="p">))</span>
    <span class="n">rng</span><span class="p">.</span><span class="n">Copy</span>
    <span class="k">Set</span> <span class="n">rng2</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">rng2</span><span class="p">.</span><span class="n">PasteSpecial</span> <span class="n">Paste</span><span class="p">:</span><span class="o">=</span><span class="n">xlPasteFormulas</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts</span>
    <span class="n">sh1</span><span class="p">.</span><span class="n">Activate</span>
    <span class="k">With</span> <span class="n">Columns</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">what</span><span class="p">:</span><span class="o">=</span><span class="s">"*"</span><span class="p">,</span> <span class="n">after</span><span class="p">:</span><span class="o">=</span><span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LookIn</span><span class="p">:</span><span class="o">=</span><span class="n">xlValues</span><span class="p">).</span><span class="n">Activate</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Ensure End Date in new row still shows EoMonth Formula</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">Copy</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">PasteSpecial</span> <span class="n">Paste</span><span class="p">:</span><span class="o">=</span><span class="n">xlPasteFormulas</span>
    
    <span class="c1">'Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts</span>
    <span class="n">sh1</span><span class="p">.</span><span class="n">Activate</span>
    <span class="k">With</span> <span class="n">Columns</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">what</span><span class="p">:</span><span class="o">=</span><span class="s">"*"</span><span class="p">,</span> <span class="n">after</span><span class="p">:</span><span class="o">=</span><span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LookIn</span><span class="p">:</span><span class="o">=</span><span class="n">xlValues</span><span class="p">).</span><span class="n">Activate</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Clear anything that may have been copied down in the Cash and Drawdown Colums - as these are manually entered</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">).</span><span class="n">ClearContents</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">).</span><span class="n">ClearContents</span>
    
    <span class="c1">'Reset Active Cell to where it should be - at first non-empty cell in Column A, where the Table starts</span>
    <span class="n">sh1</span><span class="p">.</span><span class="n">Activate</span>
    <span class="k">With</span> <span class="n">Columns</span><span class="p">(</span><span class="s">"A"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">what</span><span class="p">:</span><span class="o">=</span><span class="s">"*"</span><span class="p">,</span> <span class="n">after</span><span class="p">:</span><span class="o">=</span><span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">LookIn</span><span class="p">:</span><span class="o">=</span><span class="n">xlValues</span><span class="p">).</span><span class="n">Activate</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Interest used for Period</span>
    
    <span class="c1">'Find Fixed Interest Rate</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tblwidth</span> <span class="o">+</span> <span class="mi">3</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="n">sh1</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="s">"c17"</span><span class="p">).</span><span class="n">Value</span>
    
    <span class="c1">'Calculate Total Interest Rate</span>
    <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tblwidth</span> <span class="o">+</span> <span class="mi">2</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tblwidth</span> <span class="o">+</span> <span class="mi">4</span><span class="p">).</span><span class="n">Value</span> <span class="o">+</span> <span class="n">ActiveCell</span><span class="p">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">tblheight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tblwidth</span> <span class="o">+</span> <span class="mi">3</span><span class="p">).</span><span class="n">Value</span>

<span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Protect</span> <span class="n">Password</span><span class="p">:</span><span class="o">=</span><span class="n">pswdSheet</span>

<span class="n">MsgBox</span> <span class="s">"Loan 2 Done"</span>

<span class="k">End</span> <span class="k">Sub</span>

</code></pre></div></div>

<h2 id="download">Download</h2>

<p>The full file can be downloaded here:</p>

<p><a href="https://1drv.ms/x/s!Ahu8OSSAtOMzmCY2laZdJ4Bya3eh?e=fRl8t6" target="_blank">VBA - Financial Loan Sheets (xlsm)</a></p>

                        
                            <div id="mainNavBottom">
    <a class="no_icon" href="">
        <span id="previousPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-back" data-inline="false"></span>
        </span>
    </a>
    <a class="no_icon" href="">
        <span id="nextPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-forward" data-inline="false"></span>					
        </span>
    </a>
</div>
                        
                    </main>	
                    
                        <!-- Start of Feedback section -->
<section class="feedback-section is-relative">
    <h2 id="feedback" class="is-size-2 has-margin-top-large has-padding-top-medium"> Feedback </h2>
    <div class="feedback has-margin-top-small has-margin-bottom-none">
        <p id="send-feedback-about" class="has-margin-top-none has-margin-bottom-none">
            Submit and view feedback
        </p>
        <div id="feedback-section-link" class="has-margin-top-large has-margin-bottom-none">
            <a class="button has-margin-bottom-small" href="" target="_blank">
                <span class="icon">
                    <span class=github>
                        <i class="fab fa-github"></i>
                    </span>
                </span>
                <span>This page</span>
            </a>
        </div>
    </div>
    <div id="viewallfeedback-section-link" class="is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-medium">
        <a class="view-on-github" href="" target="_blank">
            <span class="icon">
                <span class=github>
                    <i class="fab fa-github"></i>
                </span>
            </span><span>View all page feedback</span>
        </a>
    </div>
</section>

<!-- End of Feedback section -->
                    
                </div>

                
                 <!-- Right Hand Side Toc-->
                 <div class="right-sidebar column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only">
                    <nav class="doc-outline is-fixed is-vertically-scrollable", id="affixed-right-sidebar">
                        <nav id="side-doc-outline">
                            <header id="side-doc-title" class = "is-flex is-flex-row">
                                <div>
                                    <a href="#top">
                                        <h3 title="Go to Top of Page">
                                            <i class="fas fa-file-alt" style="color:#e82127;">&nbsp;</i>
                                            In this article
                                        </h3>
                                    </a>
                                </div>
                            </header>
                            <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#screenshots">Screenshots</a></li>
<li class="toc-entry toc-h2"><a href="#vba-module-code--loan-1">VBA Module Code – Loan 1</a></li>
<li class="toc-entry toc-h2"><a href="#vba-module-code--loan-2">VBA Module Code – Loan 2</a></li>
<li class="toc-entry toc-h2"><a href="#download">Download</a></li>
</ul>
                        </nav>

                        <!-- Fixed Element-->
                        <div>
                            <a class="top-link hide" href="" id="js-top" title="Go to Top of Page">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>
                            </a>
                        </div>
                    </nav>
                </div>
                
            </div>
            <!-- end of /.columns -->
        </div>	
        <!-- end of /primary holder -->

    </div>
    <!-- end of /.columns -->
</div>
<!-- end of /.mainContainer -->
			<!-- Footer Container --> 
<div class="footerContainer">

    
    

    <footer id="footer" class=" footer-layout   uhf-container has-padding">
        <div class="">
            <a href="https://startech-enterprises.github.io/docs/">
                <img src="/../docs/assets/images/starbase_logo.png" class="footer-bar-logo">
            </a>
        </div>
        <div class="is-flex is-full-height has-padding-right-extra-large-desktop has-padding-left-extra-large-desktop">
            <a class="locale-selector-link has-flex-shrink-none" href="/../">
                <span class="icon">
                    <span><i class="fas fa-globe"></i></span>
                </span>
                <span class="locale-selector-link-text">English (United Kingdom)</span>
            </a>
        </div>
        <ul class="links">
            <li>
                <a href="/docs/">Docs</a>
            </li>
            <li>
                <a href="/docs/guides/">Guides</a>
            </li>
            <li>
                <a href="/docs/tech-blogs/">Articles & Blogs</a>
            </li>
            <li>
                <a href="/docs/videos/">Videos</a>
            </li>
            <li>
                <a href="/docs/about/">About</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/company/startech-enterprises/">LinkedIn</a>
            </li>
            <li style="color: #e82127;">
                <span class="icon">
                    <span> <i class="fas fa-star"></i></span>
                </span>Star Base 2020
            </li>
        </ul>
    </footer>
</div>
<!-- end of / footerContainer -->
	</body>
		<!-- Reference to main JavaScript Files -->
<script src="/../docs/assets/js/library.js" type="application/javascript"></script>
<script src="/../docs/assets/js/breadCrumb.js" type="application/javascript"></script>
<script src="/../docs/assets/js/navbar.js" type="application/javascript"></script>
<script src="/../docs/assets/js/affix.js" type="application/javascript"></script>
<script src="/../docs/assets/js/rhsToc.js" type="application/javascript"></script>


    <script src="/../docs/assets/js/lhsTree.js" type="application/javascript"></script>
    <script src="/../docs/assets/js/searchFilter.js" type="application/javascript"></script>


<script src="/../docs/assets/js/scrollTop.js" type="application/javascript"></script>
<script src="/../docs/assets/js/gitFeedback.js" type="application/javascript"></script>
<script src="/../docs/assets/js/copyCode.js" type="application/javascript"></script>
</html>
