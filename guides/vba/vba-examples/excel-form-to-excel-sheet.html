<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176158185-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176158185-1');
</script>

		<title>Excel Form to Excel Sheet | StarBase </title>
		<!-- link to website tab icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/../docs/assets/images/alt-logo-star-tilted.png">
		<!-- link to Main Stylesheets -->
		<link rel="stylesheet" type="text/css" href="/../docs/assets/css/styles.css">
		<!-- link to Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Zilla Slab' rel='stylesheet'>
		<link href="https://fonts.googleapis.com/css2?family=Marcellus&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@200..400&display=swap" rel="stylesheet">
		<!-- link to Font awesome -->
		<script src="https://kit.fontawesome.com/378306bc97.js" crossorigin="anonymous"></script>
		<!-- link to Material Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- link to Iconify CDN -->
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<!-- link to UUID -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv5.min.js"></script>
	</head>
	<body>
		<a id="top"></a>
			<!-- Header Holder --> 

<div class="header-holder has-default-focus"
  
  >
    <div class="nav-bar">
        <!---->
        <a class="nav-bar-button has-padding-left-medium has-padding-left-none-tablet" href="https://sachin1882.wixsite.com/startechenterprises/guides" title="Go to parent site: StarTech Enterprises">
            <div class="nav-bar-logo has-background-image">
                <img src="https://fontmeme.com/permalink/200623/587d8aec23ed76c10e0b1ec43bc85f23.png" class="alt-logo has-background-image" width="180" height ="70">
                <div class="overlay">
                    <img src="/../docs/assets/images/starbase_logo.png" class="nav-bar-logo">
                </div>
            </div>
        </a>
        <nav class="nav-bar-nav">
            <ul class="nav-bar-nav-list">
                <li class="nav-bar-item is-category has-spacing">
                    <a class = "nav-bar-button title has-hover-underline is-6 
                    
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Docs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    underline
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Guides
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/articles-and-blogs/article-search.html">
                        <span>
                            <!---->
                            Articles & Blogs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/videos/">
                        <span>
                            <!---->
                            Videos
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/about/about.html">
                        <span>
                            <!---->
                            About
                            <!---->
                        </span>
                    </a>
                </li>
            </ul>
        </nav>
        <span class = "nav-bar-spacer i-hidden-mobile"></span>
        <!---->
    </div>
</div>


<div class="header-holder transparent has-default-focus" style="position: sticky; top: 0; left: 0; right: 0;">
    <div class="content-header uhf-container has-padding has-default-focus is-flexbox" style="padding-top: 0px; padding-bottom: 1px;">
        
<!-- Get correct Breadcrumb Links from Front Matter of loaded page-->

<!-- Liquid Code -->
    <!-- Page Root -->
    

    <!-- Page Type -->
    

    <!-- Page Category -->
    

    <!-- Page Series -->
    
<!-- / End of Liquid Code -->


<!-- Breadcrumb Links --> 
<nav class = "has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow">
    <ul id="page-breadcrumbs" class="breadcrumbs">
        <li><a href="/docs/"><span class ="">Docs</span></a></li>
        <li><a href="/docs/"><span class ="">Guides</span></a></li>
        <li><a href="/docs/guides/vba/vba.html"><span class="">VBA</span></a></li>
        <li><a href=/docs/guides/vba/vba-examples/overview.html><span class="">VBA - Examples</span></a></li>

        <!-- This part needs to be generated by JavaScript-->

    </ul>
</nav>
<!-- end of / Breadcrumb links -->




        <!-- Page Functions --> 

<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
    <ul class="is-hidden-mobile action-list has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
        <li>
            <button class="print button is-text has-inner-focus is-small is-icon-only-touch colorfill" type="button" title="Print this page" onclick="window.print()">
                <span class="icon">
                    <span class="iconify extra-small" data-icon="el:print" data-inline="false"></span>                </span>
                <span class="is-visually-hidden-touch is-hidden-portrait">Print</span>
            </button>
        </li>
        <li>
            <button class="button is-text has-inner-focus is-small is-icon-only-touch colorfill" title="Send feedback about this page" onclick="location.href='#feedback'">
                <span class="icon">
                    <i class="fas fa-comments"></i>
                </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
            </button>
        </li>
        <li id="share-menu-link">
            <div class = "sharing dropdown has-caret">
                <button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch colorfill" title="Share This Document">
                    <span class="icon">
                        <span class="iconify extra-small" data-icon="ls:share" data-inline="false"></span>
                    </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
                </button>
                <div id="sharing-menu" class="sharing-menu has-padding-small is-hidden">
                    <ul>
                        <li id="twitter-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-twitter colorfill"></i>
                                </span>
                                <span>Twitter</span>
                            </a>
                        </li>
                        <li id="linkedin-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-linkedin-in colorfill"></i>
                                </span>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li id="facebook-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-facebook-f colorfill"></i>
                                </span>
                                <span>Facebook</span>
                            </a>
                        </li>
                        <li id="email-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fas fa-envelope colorfill"></i>
                                </span>
                                <span>Email</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ul>
</div>

<!-- end of / Page Functions -->
    </div>
    <div class="progress-container">
        <div class="progress-bar-scroll" id="myBar"></div>
    </div>
</div>

<!-- end of /.header-holder -->
			<!-- Main Container --> 
<div class="mainContainer uhf-container  has-top-padding ">
    <div class="columns has-large-gaps is-gapless-mobile ">

        
        <!-- Left Hand Side Tree-->
        <div class="left-sidebar column is-hidden-mobile 
         
        is-one-third-tablet is-one-quarter-desktop 
        ">
            <nav class ="is-fixed is-flex is-flex-column" id="affixed-left-sidebar">

                <!-- Include LHS Menu -->
                
                <form class = "has-margin-bottom-small" action="javascript:" role="search">
                    <label class="visually-hidden">Search</label>
                    <div class="searchFilter is-block">
                        <div class="control has-icons-left">
                            <input id="searchFilter" class="searchFilter-input input control has-icons-left is-full-width is-small" role="combobox" maxlength="100" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" placeholder="Filter by title" type="text">
                            <span class="icon is-small is-left">
                                <img src="/../docs/assets/images/filter.png" class="filter-icon">
                            </span>
                        </div>
                        <ul class="searchFilter-suggestions is-vertically-scrollable is-hidden"></ul>
                    </div>
                </form>

                <ul class="toc is-vertically-scrollable has-flex-grow has-flex-shrink">
                    <!-- Menu Series -->
                    
                    
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/overview.html">Introduction</a></li>
    
          
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Data Integration</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/data-integration.html">Data Integration</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/word-form-to-excel-table.html">Word Form to Excel Table</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/excel-form-to-excel-sheet.html">Excel Form to Excel Sheet</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/excel-form-to-excel-table.html">Excel Form to Excel Table</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/mysql-to-excel-table-1.html">MySQL to Excel Table - Ex. 1</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/mysql-to-excel-table-2.html">MySQL to Excel Table - Ex. 2</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/excel-table-to-mysql.html">Excel Table(s) to MySQL</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Automating Tasks & Calculations</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/bulk-refreshing.html">Bulk Refreshing workbooks</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/adding-data-and-comparing-lists.html">Adding Data & Comparing Lists</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/financial-loan-sheets.html">Financial Loan Sheets</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/locking-sheets.html">Locking Sheets</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Data from External Datasets</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/data-from-quandl.html">Getting Data from Quandl</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Custom Functions</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/custom-vba-functions.html">Custom VBA Functions</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>WorkBook Navigation</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/creating-a-toc.html">Creating a ToC</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/vba/vba-examples/guide-references.html">Guide References</a></li>
    
          
        
      </li>
  
</ul>
                </ul>

                <!-- Include the Correct Back Button -->
                
            </nav>
        </div>
         <!-- end of /left hand side tree -->
        

        <!-- Primary Holder -->    
        <div class="primary-holder column 
          
        is-two-thirds-tablet is-three-quarters-desktop 
        ">
            <div class="columns has-large-gaps is-gapless-mobile 
            
            ">

                 <!-- Main Column -->
                <div id="main-column" class="column 
                 
                is-full is-four-fifths-desktop 
                ">
                    <main id="main" class ="
                    
                        content docs
                    " lang="eng-us">
                        <h1 id="excel-form-to-excel-sheet">Excel Form to Excel Sheet</h1>
<time class="metadata" style="text-alstyleign:left"> Guides • VBA • 11/01/2021</time>

<h2 id="background">Background</h2>

<p>Sometimes users might not need to have to print out separate forms, but instead just enter data directly into a spreadsheet.</p>

<p>This article explains how to create a User Form in Microsoft Excel itself, that can be used to send data from this Form to any WorkSheet or Table in the same Excel WorkBook. This is useful particularly with large WorkBooks with lots of WorkSheets, where it can be difficult and time-consuming to navigate across several sheets, just to make sure your data gets to the right place.</p>

<p>Below we outline the various steps needed to create such a Form and Spreadsheet.</p>

<h2 id="design-user-form">Design User Form</h2>

<p>First Create a Form Object in Microsoft Excel by going to the VBA Editor, and design a User Form. Ensure you give each object an appropriate name (by selecting the Properties of that object), as they will need to be referenced in the VBA code.</p>

<p>Here is an example of what a User Form might look like:</p>

<figure>
    
        <img class="docimage" src="images/excel-form-to-excel-sheet-01.png" alt="" style="width: 100%; max-width: 85.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>VBA Editor - User Form</i>
    </figcaption>
    
</figure>

<figure>
    
        <img class="docimage" src="images/excel-form-to-excel-sheet-02.png" alt="" style="width: 100%; max-width: 46.2%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Excel - User Form</i>
    </figcaption>
    
</figure>

<h2 id="create-form-object-vba">Create Form Object VBA</h2>

<p>Next, create the following code for the Form Object. It might look something like this:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: VBA">VBA</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
&#39;Variable Declaration
Dim BlnVal As Boolean

Private Sub UserForm_Initialize()
    &#39;Variable declaration
    Dim IdVal As Integer
    
    &#39;Finding last row in the Data Sheet
    IdVal = fn_LastRow(Sheets(&quot;Data&quot;))
    
    &#39;Update next available id on the userform
    frmData.txtId = IdVal
End Sub

Sub cmdAdd_Click()
    On Error GoTo ErrOccured
    &#39;Boolean Value
    BlnVal = 0
    
    &#39;Data Validation
    Call Data_Validation
    
    &#39;Check validation of all fields are completed are not
    If BlnVal = 0 Then Exit Sub
      
    &#39;TurnOff screen updating
    With Application
        .ScreenUpdating = False
        .EnableEvents = False
    End With
     
    &#39;Variable declaration
    Dim txtId, txtName, GenderValue, txtLocation, txtCNum, txtEAddr, txtRemarks
    Dim iCnt As Integer
    
    &#39;find next available row to update data in the data worksheet
    iCnt = fn_LastRow(Sheets(&quot;Data&quot;)) + 1
    
    &#39;Find Gender value
    If frmData.obMale = True Then
       GenderValue = &quot;Male&quot;
    Else
       GenderValue = &quot;Female&quot;
    End If
    
    &#39;Update userform data to the Data Worksheet
    With Sheets(&quot;Data&quot;)
        .Cells(iCnt, 1) = iCnt - 1
        .Cells(iCnt, 2) = frmData.txtName
        .Cells(iCnt, 3) = GenderValue
        .Cells(iCnt, 4) = frmData.txtLocation.Value
        .Cells(iCnt, 5) = frmData.txtEAddr
        .Cells(iCnt, 6) = frmData.txtCNum
        .Cells(iCnt, 7) = frmData.txtRemarks
      
        
        &#39;Diplay headers on the first row of Data Worksheet
        If .Range(&quot;A1&quot;) = &quot;&quot; Then
            .Cells(1, 1) = &quot;Id&quot;
            .Cells(1, 2) = &quot;Name&quot;
            .Cells(1, 3) = &quot;Gender&quot;
            .Cells(1, 4) = &quot;Location&quot;
            .Cells(1, 5) = &quot;Email Addres&quot;
            .Cells(1, 6) = &quot;Contact Number&quot;
            .Cells(1, 7) = &quot;Remarks&quot;
            
            &#39;Formatiing Data
            .Columns(&quot;A:G&quot;).Columns.AutoFit
            .Range(&quot;A1:G1&quot;).Font.Bold = True
            .Range(&quot;A1:G1&quot;).LineStyle = xlDash
            
        End If
    End With
    
    &#39;Display next available Id number on the Userform
    &#39;Variable declaration
    Dim IdVal As Integer
    
    &#39;Finding last row in the Data Sheet
    IdVal = fn_LastRow(Sheets(&quot;Data&quot;))
    
    &#39;Update next available id on the userform
    frmData.txtId = IdVal
    
ErrOccured:
    &#39;TurnOn screen updating
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
End Sub

&#39;In this example we are finding the last Row of specified Sheet
Function fn_LastRow(ByVal Sht As Worksheet)

    Dim lastRow As Long
    lastRow = Sht.Cells.SpecialCells(xlLastCell).Row
    lRow = Sht.Cells.SpecialCells(xlLastCell).Row
    Do While Application.CountA(Sht.Rows(lRow)) = 0 And lRow &lt;&gt; 1
        lRow = lRow - 1
    Loop
    fn_LastRow = lRow

End Function

&#39;Exit from the Userform
Private Sub cmdCancel_Click()
    Unload Me
End Sub

&#39; Check all the data (except remarks field) has been entered on userform
Sub Data_Validation()
     If txtName = &quot;&quot; Then
        MsgBox &quot;Enter Name!&quot;, vbInformation, &quot;Name&quot;
        Exit Sub
     ElseIf frmData.obMale = False And frmData.obFMale = False Then
        MsgBox &quot;Select Gender!&quot;, vbInformation, &quot;Gender&quot;
        Exit Sub
     ElseIf txtLocation = &quot;&quot; Then
        MsgBox &quot;Enter Location!&quot;, vbInformation, &quot;Location&quot;
        Exit Sub
    ElseIf txtEAddr = &quot;&quot; Then
        MsgBox &quot;Enter Address!&quot;, vbInformation, &quot;Email Address&quot;
        Exit Sub
    ElseIf txtCNum = &quot;&quot; Then
        MsgBox &quot;Enter Contact Number!&quot;, vbInformation, &quot;Contact Number&quot;
        Exit Sub
    Else
        BlnVal = 1
    End If
End Sub

&#39;Clearing data fields of userform
Private Sub cmdClear_Click()
    Application.ScreenUpdating = False
        txtId.Text = &quot;&quot;
        txtName.Text = &quot;&quot;
        obMale.Value = True
        txtLocation = &quot;&quot;
        txtEAddr = &quot;&quot;
        txtCNum = &quot;&quot;
        txtRemarks = &quot;&quot;
    Application.ScreenUpdating = True
End Sub
">
  </button>
</div>
<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">'Variable Declaration</span>
<span class="k">Dim</span> <span class="nv">BlnVal</span> <span class="ow">As</span> <span class="kt">Boolean</span>

<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">UserForm_Initialize</span><span class="p">()</span>
    <span class="c1">'Variable declaration</span>
    <span class="k">Dim</span> <span class="nv">IdVal</span> <span class="ow">As</span> <span class="kt">Integer</span>
    
    <span class="c1">'Finding last row in the Data Sheet</span>
    <span class="n">IdVal</span> <span class="o">=</span> <span class="n">fn_LastRow</span><span class="p">(</span><span class="n">Sheets</span><span class="p">(</span><span class="s">"Data"</span><span class="p">))</span>
    
    <span class="c1">'Update next available id on the userform</span>
    <span class="n">frmData</span><span class="p">.</span><span class="n">txtId</span> <span class="o">=</span> <span class="n">IdVal</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">cmdAdd_Click</span><span class="p">()</span>
    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">ErrOccured</span>
    <span class="c1">'Boolean Value</span>
    <span class="n">BlnVal</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="c1">'Data Validation</span>
    <span class="k">Call</span> <span class="n">Data_Validation</span>
    
    <span class="c1">'Check validation of all fields are completed are not</span>
    <span class="k">If</span> <span class="n">BlnVal</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span> <span class="k">Exit</span> <span class="k">Sub</span>
      
    <span class="c1">'TurnOff screen updating</span>
    <span class="nf">With</span> <span class="n">Application</span>
        <span class="p">.</span><span class="n">ScreenUpdating</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">EnableEvents</span> <span class="o">=</span> <span class="k">False</span>
    <span class="k">End</span> <span class="k">With</span>
     
    <span class="c1">'Variable declaration</span>
    <span class="k">Dim</span> <span class="nv">txtId</span><span class="p">,</span> <span class="n">txtName</span><span class="p">,</span> <span class="n">GenderValue</span><span class="p">,</span> <span class="n">txtLocation</span><span class="p">,</span> <span class="n">txtCNum</span><span class="p">,</span> <span class="n">txtEAddr</span><span class="p">,</span> <span class="n">txtRemarks</span>
    <span class="k">Dim</span> <span class="nv">iCnt</span> <span class="ow">As</span> <span class="kt">Integer</span>
    
    <span class="c1">'find next available row to update data in the data worksheet</span>
    <span class="n">iCnt</span> <span class="o">=</span> <span class="n">fn_LastRow</span><span class="p">(</span><span class="n">Sheets</span><span class="p">(</span><span class="s">"Data"</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="c1">'Find Gender value</span>
    <span class="k">If</span> <span class="n">frmData</span><span class="p">.</span><span class="n">obMale</span> <span class="o">=</span> <span class="k">True</span> <span class="k">Then</span>
       <span class="n">GenderValue</span> <span class="o">=</span> <span class="s">"Male"</span>
    <span class="k">Else</span>
       <span class="n">GenderValue</span> <span class="o">=</span> <span class="s">"Female"</span>
    <span class="k">End</span> <span class="k">If</span>
    
    <span class="c1">'Update userform data to the Data Worksheet</span>
    <span class="k">With</span> <span class="n">Sheets</span><span class="p">(</span><span class="s">"Data"</span><span class="p">)</span>
        <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">iCnt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">iCnt</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">iCnt</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">frmData</span><span class="p">.</span><span class="n">txtName</span>
        <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">iCnt</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">GenderValue</span>
        <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">iCnt</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">frmData</span><span class="p">.</span><span class="n">txtLocation</span><span class="p">.</span><span class="n">Value</span>
        <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">iCnt</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">frmData</span><span class="p">.</span><span class="n">txtEAddr</span>
        <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">iCnt</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">frmData</span><span class="p">.</span><span class="n">txtCNum</span>
        <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">iCnt</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">frmData</span><span class="p">.</span><span class="n">txtRemarks</span>
      
        
        <span class="c1">'Diplay headers on the first row of Data Worksheet</span>
        <span class="k">If</span> <span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="s">"A1"</span><span class="p">)</span> <span class="o">=</span> <span class="s">""</span> <span class="k">Then</span>
            <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Id"</span>
            <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Name"</span>
            <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Gender"</span>
            <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Location"</span>
            <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Email Addres"</span>
            <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Contact Number"</span>
            <span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Remarks"</span>
            
            <span class="c1">'Formatiing Data</span>
            <span class="p">.</span><span class="n">Columns</span><span class="p">(</span><span class="s">"A:G"</span><span class="p">).</span><span class="n">Columns</span><span class="p">.</span><span class="n">AutoFit</span>
            <span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="s">"A1:G1"</span><span class="p">).</span><span class="n">Font</span><span class="p">.</span><span class="n">Bold</span> <span class="o">=</span> <span class="k">True</span>
            <span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="s">"A1:G1"</span><span class="p">).</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">xlDash</span>
            
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">End</span> <span class="k">With</span>
    
    <span class="c1">'Display next available Id number on the Userform</span>
    <span class="c1">'Variable declaration</span>
    <span class="k">Dim</span> <span class="nv">IdVal</span> <span class="ow">As</span> <span class="kt">Integer</span>
    
    <span class="c1">'Finding last row in the Data Sheet</span>
    <span class="n">IdVal</span> <span class="o">=</span> <span class="n">fn_LastRow</span><span class="p">(</span><span class="n">Sheets</span><span class="p">(</span><span class="s">"Data"</span><span class="p">))</span>
    
    <span class="c1">'Update next available id on the userform</span>
    <span class="n">frmData</span><span class="p">.</span><span class="n">txtId</span> <span class="o">=</span> <span class="n">IdVal</span>
    
<span class="n">ErrOccured</span><span class="p">:</span>
    <span class="c1">'TurnOn screen updating</span>
    <span class="n">Application</span><span class="p">.</span><span class="n">ScreenUpdating</span> <span class="o">=</span> <span class="k">True</span>
    <span class="n">Application</span><span class="p">.</span><span class="n">EnableEvents</span> <span class="o">=</span> <span class="k">True</span>
    
<span class="k">End</span> <span class="k">Sub</span>

<span class="c1">'In this example we are finding the last Row of specified Sheet</span>
<span class="k">Function</span> <span class="nf">fn_LastRow</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">Sht</span> <span class="ow">As</span> <span class="n">Worksheet</span><span class="p">)</span>

    <span class="k">Dim</span> <span class="nv">lastRow</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="n">lastRow</span> <span class="o">=</span> <span class="n">Sht</span><span class="p">.</span><span class="n">Cells</span><span class="p">.</span><span class="n">SpecialCells</span><span class="p">(</span><span class="n">xlLastCell</span><span class="p">).</span><span class="n">Row</span>
    <span class="n">lRow</span> <span class="o">=</span> <span class="n">Sht</span><span class="p">.</span><span class="n">Cells</span><span class="p">.</span><span class="n">SpecialCells</span><span class="p">(</span><span class="n">xlLastCell</span><span class="p">).</span><span class="n">Row</span>
    <span class="k">Do</span> <span class="k">While</span> <span class="n">Application</span><span class="p">.</span><span class="n">CountA</span><span class="p">(</span><span class="n">Sht</span><span class="p">.</span><span class="n">Rows</span><span class="p">(</span><span class="n">lRow</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span> <span class="ow">And</span> <span class="n">lRow</span> <span class="o">&lt;&gt;</span> <span class="mi">1</span>
        <span class="n">lRow</span> <span class="o">=</span> <span class="n">lRow</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">Loop</span>
    <span class="n">fn_LastRow</span> <span class="o">=</span> <span class="n">lRow</span>

<span class="k">End</span> <span class="k">Function</span>

<span class="c1">'Exit from the Userform</span>
<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdCancel_Click</span><span class="p">()</span>
    <span class="n">Unload</span> <span class="k">Me</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="c1">' Check all the data (except remarks field) has been entered on userform</span>
<span class="k">Sub</span> <span class="nf">Data_Validation</span><span class="p">()</span>
     <span class="k">If</span> <span class="n">txtName</span> <span class="o">=</span> <span class="s">""</span> <span class="k">Then</span>
        <span class="n">MsgBox</span> <span class="s">"Enter Name!"</span><span class="p">,</span> <span class="n">vbInformation</span><span class="p">,</span> <span class="s">"Name"</span>
        <span class="k">Exit</span> <span class="k">Sub</span>
     <span class="nf">ElseIf</span> <span class="n">frmData</span><span class="p">.</span><span class="n">obMale</span> <span class="o">=</span> <span class="k">False</span> <span class="ow">And</span> <span class="n">frmData</span><span class="p">.</span><span class="n">obFMale</span> <span class="o">=</span> <span class="k">False</span> <span class="k">Then</span>
        <span class="n">MsgBox</span> <span class="s">"Select Gender!"</span><span class="p">,</span> <span class="n">vbInformation</span><span class="p">,</span> <span class="s">"Gender"</span>
        <span class="k">Exit</span> <span class="k">Sub</span>
     <span class="nf">ElseIf</span> <span class="n">txtLocation</span> <span class="o">=</span> <span class="s">""</span> <span class="k">Then</span>
        <span class="n">MsgBox</span> <span class="s">"Enter Location!"</span><span class="p">,</span> <span class="n">vbInformation</span><span class="p">,</span> <span class="s">"Location"</span>
        <span class="k">Exit</span> <span class="k">Sub</span>
    <span class="nf">ElseIf</span> <span class="n">txtEAddr</span> <span class="o">=</span> <span class="s">""</span> <span class="k">Then</span>
        <span class="n">MsgBox</span> <span class="s">"Enter Address!"</span><span class="p">,</span> <span class="n">vbInformation</span><span class="p">,</span> <span class="s">"Email Address"</span>
        <span class="k">Exit</span> <span class="k">Sub</span>
    <span class="nf">ElseIf</span> <span class="n">txtCNum</span> <span class="o">=</span> <span class="s">""</span> <span class="k">Then</span>
        <span class="n">MsgBox</span> <span class="s">"Enter Contact Number!"</span><span class="p">,</span> <span class="n">vbInformation</span><span class="p">,</span> <span class="s">"Contact Number"</span>
        <span class="k">Exit</span> <span class="k">Sub</span>
    <span class="nf">Else</span>
        <span class="n">BlnVal</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="c1">'Clearing data fields of userform</span>
<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdClear_Click</span><span class="p">()</span>
    <span class="n">Application</span><span class="p">.</span><span class="n">ScreenUpdating</span> <span class="o">=</span> <span class="k">False</span>
        <span class="n">txtId</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">txtName</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">obMale</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="k">True</span>
        <span class="n">txtLocation</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">txtEAddr</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">txtCNum</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">txtRemarks</span> <span class="o">=</span> <span class="s">""</span>
    <span class="n">Application</span><span class="p">.</span><span class="n">ScreenUpdating</span> <span class="o">=</span> <span class="k">True</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<h2 id="activate-correct-vba-objects-in-excel">Activate correct VBA Objects (in Excel)</h2>

<p>The important one is Microsoft Forms 2.0 Object Library, as shown below:</p>

<figure>
    
        <img class="docimage" src="images/excel-form-to-excel-sheet-03.png" alt="" style="width: 100%; max-width: 65.9%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>VBA - Reference Tools</i>
    </figcaption>
    
</figure>

<h2 id="design-spreadsheet">Design Spreadsheet</h2>

<p>Now design a consistent spreadsheet, according to the User Form created earlier. You will also need to create two buttons, one for Clearing the Table in the Worksheet, and the other for Showing the User Form.</p>

<figure>
    
        <img class="docimage" src="images/excel-form-to-excel-sheet-04.png" alt="" style="width: 100%; max-width: 85.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Front Sheet</i>
    </figcaption>
    
</figure>

<figure>
    
        <img class="docimage" src="images/excel-form-to-excel-sheet-05.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Data Sheet</i>
    </figcaption>
    
</figure>

<h2 id="create-vba-module">Create VBA Module</h2>

<p>Now, create the VBA code that goes into the VBA Module of the WorkBook, and assign each of these macros to the buttons on the WorkSheet (See the spreadsheet pictures earlier with the green and blue buttons.)</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: VBA">VBA</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Sub Oval2_Click()
    frmData.Show
End Sub
Sub Clear_DataSheet()
    Sheets(&quot;Data&quot;).Columns(&quot;A:G&quot;).Clear
End Sub
">
  </button>
</div>
<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Sub</span> <span class="nf">Oval2_Click</span><span class="p">()</span>
    <span class="n">frmData</span><span class="p">.</span><span class="n">Show</span>
<span class="k">End</span> <span class="k">Sub</span>
<span class="k">Sub</span> <span class="nf">Clear_DataSheet</span><span class="p">()</span>
    <span class="n">Sheets</span><span class="p">(</span><span class="s">"Data"</span><span class="p">).</span><span class="n">Columns</span><span class="p">(</span><span class="s">"A:G"</span><span class="p">).</span><span class="n">Clear</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<figure>
    
        <img class="docimage" src="images/excel-form-to-excel-sheet-06.png" alt="" style="width: 100%; max-width: 89%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>VBA Editor - Module</i>
    </figcaption>
    
</figure>

<p>That’s it! You should be able to send the data from the Excel User Form to anywhere in the WorkBook at the simple click of a button!</p>

<h2 id="download">Download</h2>

<p>The full file can be downloaded here:</p>

<p><a href="https://1drv.ms/x/s!Ahu8OSSAtOMzmAKS-G4egwDrj2TT?e=jfGpfS" target="_blank">VBA - Excel Form to Excel Sheet (xlsm)</a></p>

                        
                            <div id="mainNavBottom">
    <a class="no_icon" href="">
        <span id="previousPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-back" data-inline="false"></span>
        </span>
    </a>
    <a class="no_icon" href="">
        <span id="nextPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-forward" data-inline="false"></span>					
        </span>
    </a>
</div>
                        
                    </main>	
                    
                        <!-- Start of Feedback section -->
<section class="feedback-section is-relative">
    <h2 id="feedback" class="is-size-2 has-margin-top-large has-padding-top-medium"> Feedback </h2>
    <div class="feedback has-margin-top-small has-margin-bottom-none">
        <p id="send-feedback-about" class="has-margin-top-none has-margin-bottom-none">
            Submit and view feedback
        </p>
        <div id="feedback-section-link" class="has-margin-top-large has-margin-bottom-none">
            <a class="button has-margin-bottom-small" href="" target="_blank">
                <span class="icon">
                    <span class=github>
                        <i class="fab fa-github"></i>
                    </span>
                </span>
                <span>This page</span>
            </a>
        </div>
    </div>
    <div id="viewallfeedback-section-link" class="is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-medium">
        <a class="view-on-github" href="" target="_blank">
            <span class="icon">
                <span class=github>
                    <i class="fab fa-github"></i>
                </span>
            </span><span>View all page feedback</span>
        </a>
    </div>
</section>

<!-- End of Feedback section -->
                    
                </div>

                
                 <!-- Right Hand Side Toc-->
                 <div class="right-sidebar column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only">
                    <nav class="doc-outline is-fixed is-vertically-scrollable", id="affixed-right-sidebar">
                        <nav id="side-doc-outline">
                            <header id="side-doc-title" class = "is-flex is-flex-row">
                                <div>
                                    <a href="#top">
                                        <h3 title="Go to Top of Page">
                                            <i class="fas fa-file-alt" style="color:#e82127;">&nbsp;</i>
                                            In this article
                                        </h3>
                                    </a>
                                </div>
                            </header>
                            <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#background">Background</a></li>
<li class="toc-entry toc-h2"><a href="#design-user-form">Design User Form</a></li>
<li class="toc-entry toc-h2"><a href="#create-form-object-vba">Create Form Object VBA</a></li>
<li class="toc-entry toc-h2"><a href="#activate-correct-vba-objects-in-excel">Activate correct VBA Objects (in Excel)</a></li>
<li class="toc-entry toc-h2"><a href="#design-spreadsheet">Design Spreadsheet</a></li>
<li class="toc-entry toc-h2"><a href="#create-vba-module">Create VBA Module</a></li>
<li class="toc-entry toc-h2"><a href="#download">Download</a></li>
</ul>
                        </nav>

                        <!-- Fixed Element-->
                        <div>
                            <a class="top-link hide" href="" id="js-top" title="Go to Top of Page">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>
                            </a>
                        </div>
                    </nav>
                </div>
                
            </div>
            <!-- end of /.columns -->
        </div>	
        <!-- end of /primary holder -->

    </div>
    <!-- end of /.columns -->
</div>
<!-- end of /.mainContainer -->
			<!-- Footer Container --> 
<div class="footerContainer">

    
    

    <footer id="footer" class=" footer-layout   uhf-container has-padding">
        <div class="">
            <a href="https://startech-enterprises.github.io/docs/">
                <img src="/../docs/assets/images/starbase_logo.png" class="footer-bar-logo">
            </a>
        </div>
        <div class="is-flex is-full-height has-padding-right-extra-large-desktop has-padding-left-extra-large-desktop">
            <a class="locale-selector-link has-flex-shrink-none" href="/../">
                <span class="icon">
                    <span><i class="fas fa-globe"></i></span>
                </span>
                <span class="locale-selector-link-text">English (United Kingdom)</span>
            </a>
        </div>
        <ul class="links">
            <li>
                <a href="/docs/">Docs</a>
            </li>
            <li>
                <a href="/docs/">Guides</a>
            </li>
            <li>
                <a href="/docs/articles-and-blogs/article-search.html">Articles & Blogs</a>
            </li>
            <li>
                <a href="/docs/videos/">Videos</a>
            </li>
            <li>
                <a href="/docs/about/about.html">About</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/company/startech-enterprises/" target="_blank">LinkedIn</a>
            </li>
            <li style="color: #e82127;">
                <span class="icon">
                    <span> <i class="fas fa-star"></i></span>
                </span>Star Base 2020
            </li>
        </ul>
    </footer>
</div>
<!-- end of / footerContainer -->
	</body>
		<!-- Reference to main JavaScript Files -->
<script src="/../docs/assets/js/library.js" type="application/javascript"></script>
<script src="/../docs/assets/js/breadCrumb.js" type="application/javascript"></script>
<script src="/../docs/assets/js/navbar.js" type="application/javascript"></script>
<script src="/../docs/assets/js/affix.js" type="application/javascript"></script>
<script src="/../docs/assets/js/rhsToc.js" type="application/javascript"></script>


    <script src="/../docs/assets/js/lhsTree.js" type="application/javascript"></script>
    <script src="/../docs/assets/js/searchFilter.js" type="application/javascript"></script>


<script src="/../docs/assets/js/scrollTop.js" type="application/javascript"></script>
<script src="/../docs/assets/js/gitFeedback.js" type="application/javascript"></script>
<script src="/../docs/assets/js/copyCode.js" type="application/javascript"></script>
</html>
